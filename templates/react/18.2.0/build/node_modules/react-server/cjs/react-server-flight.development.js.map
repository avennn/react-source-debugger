{"version":3,"file":"react-server-flight.development.js","sources":["../../../../packages/shared/ReactSharedInternals.js","../../../../packages/shared/consoleWithStackDev.js","../../../../packages/react-server/src/forks/ReactServerStreamConfig.custom.js","../../../../packages/react-server/src/ReactFlightServerConfigStream.js","../../../../packages/react-server/src/ReactFlightServerBundlerConfigCustom.js","../../../../packages/shared/ReactSymbols.js","../../../../packages/react-server/src/forks/ReactServerFormatConfig.custom.js","../../../../packages/react-server/src/ReactFlightNewContext.js","../../../../packages/react-server/src/ReactFlightHooks.js","../../../../packages/shared/ReactServerContextRegistry.js","../../../../packages/shared/isArray.js","../../../../packages/react-server/src/ReactFlightServer.js"],"sourcesContent":["/**\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\nimport * as React from 'react';\n\nconst ReactSharedInternals =\n  React.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;\n\nexport default ReactSharedInternals;\n","/**\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport ReactSharedInternals from 'shared/ReactSharedInternals';\n\nlet suppressWarning = false;\nexport function setSuppressWarning(newSuppressWarning) {\n  if (__DEV__) {\n    suppressWarning = newSuppressWarning;\n  }\n}\n\n// In DEV, calls to console.warn and console.error get replaced\n// by calls to these methods by a Babel plugin.\n//\n// In PROD (or in packages without access to React internals),\n// they are left as they are instead.\n\nexport function warn(format, ...args) {\n  if (__DEV__) {\n    if (!suppressWarning) {\n      printWarning('warn', format, args);\n    }\n  }\n}\n\nexport function error(format, ...args) {\n  if (__DEV__) {\n    if (!suppressWarning) {\n      printWarning('error', format, args);\n    }\n  }\n}\n\nfunction printWarning(level, format, args) {\n  // When changing this logic, you might want to also\n  // update consoleWithStackDev.www.js as well.\n  if (__DEV__) {\n    const ReactDebugCurrentFrame = ReactSharedInternals.ReactDebugCurrentFrame;\n    const stack = ReactDebugCurrentFrame.getStackAddendum();\n    if (stack !== '') {\n      format += '%s';\n      args = args.concat([stack]);\n    }\n\n    // eslint-disable-next-line react-internal/safe-string-coercion\n    const argsWithFormat = args.map(item => String(item));\n    // Careful: RN currently depends on this prefix\n    argsWithFormat.unshift('Warning: ' + format);\n    // We intentionally don't use spread (or .apply) directly because it\n    // breaks IE9: https://github.com/facebook/react/issues/13610\n    // eslint-disable-next-line react-internal/no-production-logging\n    Function.prototype.apply.call(console[level], console, argsWithFormat);\n  }\n}\n","/**\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\n// This is a host config that's used for the `react-server` package on npm.\n// It is only used by third-party renderers.\n//\n// Its API lets you pass the host config as an argument.\n// However, inside the `react-server` we treat host config as a module.\n// This file is a shim between two worlds.\n//\n// It works because the `react-server` bundle is wrapped in something like:\n//\n// module.exports = function ($$$config) {\n//   /* renderer code */\n// }\n//\n// So `$$$config` looks like a global variable, but it's\n// really an argument to a top-level wrapping function.\n\ndeclare var $$$hostConfig: any;\nexport opaque type Destination = mixed; // eslint-disable-line no-undef\n\nexport opaque type PrecomputedChunk = mixed; // eslint-disable-line no-undef\nexport opaque type Chunk = mixed; // eslint-disable-line no-undef\n\nexport const scheduleWork = $$$hostConfig.scheduleWork;\nexport const beginWriting = $$$hostConfig.beginWriting;\nexport const writeChunk = $$$hostConfig.writeChunk;\nexport const writeChunkAndReturn = $$$hostConfig.writeChunkAndReturn;\nexport const completeWriting = $$$hostConfig.completeWriting;\nexport const flushBuffered = $$$hostConfig.flushBuffered;\nexport const close = $$$hostConfig.close;\nexport const closeWithError = $$$hostConfig.closeWithError;\nexport const stringToChunk = $$$hostConfig.stringToChunk;\nexport const stringToPrecomputedChunk = $$$hostConfig.stringToPrecomputedChunk;\n","/**\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\n// This file is an intermediate layer to translate between Flight\n// calls to stream output over a binary stream.\n\n/*\nFLIGHT PROTOCOL GRAMMAR\n\nResponse\n- RowSequence\n\nRowSequence\n- Row RowSequence\n- Row\n\nRow\n- \"J\" RowID JSONData\n- \"M\" RowID JSONModuleData\n- \"H\" RowID HTMLData\n- \"B\" RowID BlobData\n- \"U\" RowID URLData\n- \"E\" RowID ErrorData\n\nRowID\n- HexDigits \":\"\n\nHexDigits\n- HexDigit HexDigits\n- HexDigit\n\nHexDigit\n- 0-F\n\nURLData\n- (UTF8 encoded URL) \"\\n\"\n\nErrorData\n- (UTF8 encoded JSON: {message: \"...\", stack: \"...\"}) \"\\n\"\n\nJSONData\n- (UTF8 encoded JSON) \"\\n\"\n  - String values that begin with $ are escaped with a \"$\" prefix.\n  - References to other rows are encoding as JSONReference strings.\n\nJSONReference\n- \"$\" HexDigits\n\nHTMLData\n- ByteSize (UTF8 encoded HTML)\n\nBlobData\n- ByteSize (Binary Data)\n\nByteSize\n- (unsigned 32-bit integer)\n*/\n\n// TODO: Implement HTMLData, BlobData and URLData.\n\nimport type {Request, ReactModel} from 'react-server/src/ReactFlightServer';\n\nimport {stringToChunk} from './ReactServerStreamConfig';\n\nimport type {Chunk} from './ReactServerStreamConfig';\n\nexport type {Destination, Chunk} from './ReactServerStreamConfig';\n\nconst stringify = JSON.stringify;\n\nfunction serializeRowHeader(tag: string, id: number) {\n  return tag + id.toString(16) + ':';\n}\n\nexport function processErrorChunk(\n  request: Request,\n  id: number,\n  message: string,\n  stack: string,\n): Chunk {\n  const errorInfo = {message, stack};\n  const row = serializeRowHeader('E', id) + stringify(errorInfo) + '\\n';\n  return stringToChunk(row);\n}\n\nexport function processModelChunk(\n  request: Request,\n  id: number,\n  model: ReactModel,\n): Chunk {\n  const json = stringify(model, request.toJSON);\n  const row = serializeRowHeader('J', id) + json + '\\n';\n  return stringToChunk(row);\n}\n\nexport function processModuleChunk(\n  request: Request,\n  id: number,\n  moduleMetaData: ReactModel,\n): Chunk {\n  const json = stringify(moduleMetaData);\n  const row = serializeRowHeader('M', id) + json + '\\n';\n  return stringToChunk(row);\n}\n\nexport function processProviderChunk(\n  request: Request,\n  id: number,\n  contextName: string,\n): Chunk {\n  const row = serializeRowHeader('P', id) + contextName + '\\n';\n  return stringToChunk(row);\n}\n\nexport function processSymbolChunk(\n  request: Request,\n  id: number,\n  name: string,\n): Chunk {\n  const json = stringify(name);\n  const row = serializeRowHeader('S', id) + json + '\\n';\n  return stringToChunk(row);\n}\n\nexport {\n  scheduleWork,\n  flushBuffered,\n  beginWriting,\n  writeChunk,\n  writeChunkAndReturn,\n  completeWriting,\n  close,\n  closeWithError,\n} from './ReactServerStreamConfig';\n","/**\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\ndeclare var $$$hostConfig: any;\n\nexport opaque type BundlerConfig = mixed; // eslint-disable-line no-undef\nexport opaque type ModuleReference<T> = mixed; // eslint-disable-line no-undef\nexport opaque type ModuleMetaData: any = mixed; // eslint-disable-line no-undef\nexport opaque type ModuleKey: any = mixed; // eslint-disable-line no-undef\nexport const isModuleReference = $$$hostConfig.isModuleReference;\nexport const getModuleKey = $$$hostConfig.getModuleKey;\nexport const resolveModuleMetaData = $$$hostConfig.resolveModuleMetaData;\n","/**\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\n// ATTENTION\n// When adding new symbols to this file,\n// Please consider also adding to 'react-devtools-shared/src/backend/ReactSymbols'\n\n// The Symbol used to tag the ReactElement-like types.\nexport const REACT_ELEMENT_TYPE = Symbol.for('react.element');\nexport const REACT_PORTAL_TYPE = Symbol.for('react.portal');\nexport const REACT_FRAGMENT_TYPE = Symbol.for('react.fragment');\nexport const REACT_STRICT_MODE_TYPE = Symbol.for('react.strict_mode');\nexport const REACT_PROFILER_TYPE = Symbol.for('react.profiler');\nexport const REACT_PROVIDER_TYPE = Symbol.for('react.provider');\nexport const REACT_CONTEXT_TYPE = Symbol.for('react.context');\nexport const REACT_SERVER_CONTEXT_TYPE = Symbol.for('react.server_context');\nexport const REACT_FORWARD_REF_TYPE = Symbol.for('react.forward_ref');\nexport const REACT_SUSPENSE_TYPE = Symbol.for('react.suspense');\nexport const REACT_SUSPENSE_LIST_TYPE = Symbol.for('react.suspense_list');\nexport const REACT_MEMO_TYPE = Symbol.for('react.memo');\nexport const REACT_LAZY_TYPE = Symbol.for('react.lazy');\nexport const REACT_SCOPE_TYPE = Symbol.for('react.scope');\nexport const REACT_DEBUG_TRACING_MODE_TYPE = Symbol.for(\n  'react.debug_trace_mode',\n);\nexport const REACT_OFFSCREEN_TYPE = Symbol.for('react.offscreen');\nexport const REACT_LEGACY_HIDDEN_TYPE = Symbol.for('react.legacy_hidden');\nexport const REACT_CACHE_TYPE = Symbol.for('react.cache');\nexport const REACT_TRACING_MARKER_TYPE = Symbol.for('react.tracing_marker');\nexport const REACT_SERVER_CONTEXT_DEFAULT_VALUE_NOT_LOADED = Symbol.for(\n  'react.default_value',\n);\n\nconst MAYBE_ITERATOR_SYMBOL = Symbol.iterator;\nconst FAUX_ITERATOR_SYMBOL = '@@iterator';\n\nexport function getIteratorFn(maybeIterable: ?any): ?() => ?Iterator<*> {\n  if (maybeIterable === null || typeof maybeIterable !== 'object') {\n    return null;\n  }\n  const maybeIterator =\n    (MAYBE_ITERATOR_SYMBOL && maybeIterable[MAYBE_ITERATOR_SYMBOL]) ||\n    maybeIterable[FAUX_ITERATOR_SYMBOL];\n  if (typeof maybeIterator === 'function') {\n    return maybeIterator;\n  }\n  return null;\n}\n","/**\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\n// This is a host config that's used for the `react-server` package on npm.\n// It is only used by third-party renderers.\n//\n// Its API lets you pass the host config as an argument.\n// However, inside the `react-server` we treat host config as a module.\n// This file is a shim between two worlds.\n//\n// It works because the `react-server` bundle is wrapped in something like:\n//\n// module.exports = function ($$$config) {\n//   /* renderer code */\n// }\n//\n// So `$$$config` looks like a global variable, but it's\n// really an argument to a top-level wrapping function.\n\ndeclare var $$$hostConfig: any;\nexport opaque type Destination = mixed; // eslint-disable-line no-undef\nexport opaque type ResponseState = mixed;\nexport opaque type FormatContext = mixed;\nexport opaque type SuspenseBoundaryID = mixed;\n\nexport const isPrimaryRenderer = false;\n\nexport const getChildFormatContext = $$$hostConfig.getChildFormatContext;\nexport const UNINITIALIZED_SUSPENSE_BOUNDARY_ID =\n  $$$hostConfig.UNINITIALIZED_SUSPENSE_BOUNDARY_ID;\nexport const assignSuspenseBoundaryID = $$$hostConfig.assignSuspenseBoundaryID;\nexport const makeId = $$$hostConfig.makeId;\nexport const pushTextInstance = $$$hostConfig.pushTextInstance;\nexport const pushStartInstance = $$$hostConfig.pushStartInstance;\nexport const pushEndInstance = $$$hostConfig.pushEndInstance;\nexport const pushStartCompletedSuspenseBoundary =\n  $$$hostConfig.pushStartCompletedSuspenseBoundary;\nexport const pushEndCompletedSuspenseBoundary =\n  $$$hostConfig.pushEndCompletedSuspenseBoundary;\nexport const pushSegmentFinale = $$$hostConfig.pushSegmentFinale;\nexport const writeCompletedRoot = $$$hostConfig.writeCompletedRoot;\nexport const writePlaceholder = $$$hostConfig.writePlaceholder;\nexport const writeStartCompletedSuspenseBoundary =\n  $$$hostConfig.writeStartCompletedSuspenseBoundary;\nexport const writeStartPendingSuspenseBoundary =\n  $$$hostConfig.writeStartPendingSuspenseBoundary;\nexport const writeStartClientRenderedSuspenseBoundary =\n  $$$hostConfig.writeStartClientRenderedSuspenseBoundary;\nexport const writeEndCompletedSuspenseBoundary =\n  $$$hostConfig.writeEndCompletedSuspenseBoundary;\nexport const writeEndPendingSuspenseBoundary =\n  $$$hostConfig.writeEndPendingSuspenseBoundary;\nexport const writeEndClientRenderedSuspenseBoundary =\n  $$$hostConfig.writeEndClientRenderedSuspenseBoundary;\nexport const writeStartSegment = $$$hostConfig.writeStartSegment;\nexport const writeEndSegment = $$$hostConfig.writeEndSegment;\nexport const writeCompletedSegmentInstruction =\n  $$$hostConfig.writeCompletedSegmentInstruction;\nexport const writeCompletedBoundaryInstruction =\n  $$$hostConfig.writeCompletedBoundaryInstruction;\nexport const writeClientRenderBoundaryInstruction =\n  $$$hostConfig.writeClientRenderBoundaryInstruction;\n","/**\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\nimport type {\n  ReactServerContext,\n  ServerContextJSONValue,\n} from 'shared/ReactTypes';\n\nimport {REACT_SERVER_CONTEXT_DEFAULT_VALUE_NOT_LOADED} from 'shared/ReactSymbols';\nimport {isPrimaryRenderer} from './ReactServerFormatConfig';\n\nlet rendererSigil;\nif (__DEV__) {\n  // Use this to detect multiple renderers using the same context\n  rendererSigil = {};\n}\n\n// Used to store the parent path of all context overrides in a shared linked list.\n// Forming a reverse tree.\ntype ContextNode<T: ServerContextJSONValue> = {\n  parent: null | ContextNode<any>,\n  depth: number, // Short hand to compute the depth of the tree at this node.\n  context: ReactServerContext<T>,\n  parentValue: T,\n  value: T,\n};\n\n// The structure of a context snapshot is an implementation of this file.\n// Currently, it's implemented as tracking the current active node.\nexport opaque type ContextSnapshot = null | ContextNode<any>;\n\nexport const rootContextSnapshot: ContextSnapshot = null;\n\n// We assume that this runtime owns the \"current\" field on all ReactContext instances.\n// This global (actually thread local) state represents what state all those \"current\",\n// fields are currently in.\nlet currentActiveSnapshot: ContextSnapshot = null;\n\nfunction popNode(prev: ContextNode<any>): void {\n  if (isPrimaryRenderer) {\n    prev.context._currentValue = prev.parentValue;\n  } else {\n    prev.context._currentValue2 = prev.parentValue;\n  }\n}\n\nfunction pushNode(next: ContextNode<any>): void {\n  if (isPrimaryRenderer) {\n    next.context._currentValue = next.value;\n  } else {\n    next.context._currentValue2 = next.value;\n  }\n}\n\nfunction popToNearestCommonAncestor(\n  prev: ContextNode<any>,\n  next: ContextNode<any>,\n): void {\n  if (prev === next) {\n    // We've found a shared ancestor. We don't need to pop nor reapply this one or anything above.\n  } else {\n    popNode(prev);\n    const parentPrev = prev.parent;\n    const parentNext = next.parent;\n    if (parentPrev === null) {\n      if (parentNext !== null) {\n        throw new Error(\n          'The stacks must reach the root at the same time. This is a bug in React.',\n        );\n      }\n    } else {\n      if (parentNext === null) {\n        throw new Error(\n          'The stacks must reach the root at the same time. This is a bug in React.',\n        );\n      }\n\n      popToNearestCommonAncestor(parentPrev, parentNext);\n      // On the way back, we push the new ones that weren't common.\n      pushNode(next);\n    }\n  }\n}\n\nfunction popAllPrevious(prev: ContextNode<any>): void {\n  popNode(prev);\n  const parentPrev = prev.parent;\n  if (parentPrev !== null) {\n    popAllPrevious(parentPrev);\n  }\n}\n\nfunction pushAllNext(next: ContextNode<any>): void {\n  const parentNext = next.parent;\n  if (parentNext !== null) {\n    pushAllNext(parentNext);\n  }\n  pushNode(next);\n}\n\nfunction popPreviousToCommonLevel(\n  prev: ContextNode<any>,\n  next: ContextNode<any>,\n): void {\n  popNode(prev);\n  const parentPrev = prev.parent;\n\n  if (parentPrev === null) {\n    throw new Error(\n      'The depth must equal at least at zero before reaching the root. This is a bug in React.',\n    );\n  }\n\n  if (parentPrev.depth === next.depth) {\n    // We found the same level. Now we just need to find a shared ancestor.\n    popToNearestCommonAncestor(parentPrev, next);\n  } else {\n    // We must still be deeper.\n    popPreviousToCommonLevel(parentPrev, next);\n  }\n}\n\nfunction popNextToCommonLevel(\n  prev: ContextNode<any>,\n  next: ContextNode<any>,\n): void {\n  const parentNext = next.parent;\n\n  if (parentNext === null) {\n    throw new Error(\n      'The depth must equal at least at zero before reaching the root. This is a bug in React.',\n    );\n  }\n\n  if (prev.depth === parentNext.depth) {\n    // We found the same level. Now we just need to find a shared ancestor.\n    popToNearestCommonAncestor(prev, parentNext);\n  } else {\n    // We must still be deeper.\n    popNextToCommonLevel(prev, parentNext);\n  }\n  pushNode(next);\n}\n\n// Perform context switching to the new snapshot.\n// To make it cheap to read many contexts, while not suspending, we make the switch eagerly by\n// updating all the context's current values. That way reads, always just read the current value.\n// At the cost of updating contexts even if they're never read by this subtree.\nexport function switchContext(newSnapshot: ContextSnapshot): void {\n  // The basic algorithm we need to do is to pop back any contexts that are no longer on the stack.\n  // We also need to update any new contexts that are now on the stack with the deepest value.\n  // The easiest way to update new contexts is to just reapply them in reverse order from the\n  // perspective of the backpointers. To avoid allocating a lot when switching, we use the stack\n  // for that. Therefore this algorithm is recursive.\n  // 1) First we pop which ever snapshot tree was deepest. Popping old contexts as we go.\n  // 2) Then we find the nearest common ancestor from there. Popping old contexts as we go.\n  // 3) Then we reapply new contexts on the way back up the stack.\n  const prev = currentActiveSnapshot;\n  const next = newSnapshot;\n  if (prev !== next) {\n    if (prev === null) {\n      // $FlowFixMe: This has to be non-null since it's not equal to prev.\n      pushAllNext(next);\n    } else if (next === null) {\n      popAllPrevious(prev);\n    } else if (prev.depth === next.depth) {\n      popToNearestCommonAncestor(prev, next);\n    } else if (prev.depth > next.depth) {\n      popPreviousToCommonLevel(prev, next);\n    } else {\n      popNextToCommonLevel(prev, next);\n    }\n    currentActiveSnapshot = next;\n  }\n}\n\nexport function pushProvider<T: ServerContextJSONValue>(\n  context: ReactServerContext<T>,\n  nextValue: T,\n): ContextSnapshot {\n  let prevValue;\n  if (isPrimaryRenderer) {\n    prevValue = context._currentValue;\n    context._currentValue = nextValue;\n    if (__DEV__) {\n      if (\n        context._currentRenderer !== undefined &&\n        context._currentRenderer !== null &&\n        context._currentRenderer !== rendererSigil\n      ) {\n        console.error(\n          'Detected multiple renderers concurrently rendering the ' +\n            'same context provider. This is currently unsupported.',\n        );\n      }\n      context._currentRenderer = rendererSigil;\n    }\n  } else {\n    prevValue = context._currentValue2;\n    context._currentValue2 = nextValue;\n    if (__DEV__) {\n      if (\n        context._currentRenderer2 !== undefined &&\n        context._currentRenderer2 !== null &&\n        context._currentRenderer2 !== rendererSigil\n      ) {\n        console.error(\n          'Detected multiple renderers concurrently rendering the ' +\n            'same context provider. This is currently unsupported.',\n        );\n      }\n      context._currentRenderer2 = rendererSigil;\n    }\n  }\n  const prevNode = currentActiveSnapshot;\n  const newNode: ContextNode<T> = {\n    parent: prevNode,\n    depth: prevNode === null ? 0 : prevNode.depth + 1,\n    context: context,\n    parentValue: prevValue,\n    value: nextValue,\n  };\n  currentActiveSnapshot = newNode;\n  return newNode;\n}\n\nexport function popProvider(): ContextSnapshot {\n  const prevSnapshot = currentActiveSnapshot;\n\n  if (prevSnapshot === null) {\n    throw new Error(\n      'Tried to pop a Context at the root of the app. This is a bug in React.',\n    );\n  }\n\n  if (isPrimaryRenderer) {\n    const value = prevSnapshot.parentValue;\n    if (value === REACT_SERVER_CONTEXT_DEFAULT_VALUE_NOT_LOADED) {\n      prevSnapshot.context._currentValue = prevSnapshot.context._defaultValue;\n    } else {\n      prevSnapshot.context._currentValue = value;\n    }\n  } else {\n    const value = prevSnapshot.parentValue;\n    if (value === REACT_SERVER_CONTEXT_DEFAULT_VALUE_NOT_LOADED) {\n      prevSnapshot.context._currentValue2 = prevSnapshot.context._defaultValue;\n    } else {\n      prevSnapshot.context._currentValue2 = value;\n    }\n  }\n  return (currentActiveSnapshot = prevSnapshot.parent);\n}\n\nexport function getActiveContext(): ContextSnapshot {\n  return currentActiveSnapshot;\n}\n\nexport function readContext<T>(context: ReactServerContext<T>): T {\n  const value = isPrimaryRenderer\n    ? context._currentValue\n    : context._currentValue2;\n  return value;\n}\n","/**\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\nimport type {Dispatcher as DispatcherType} from 'react-reconciler/src/ReactInternalTypes';\nimport type {Request} from './ReactFlightServer';\nimport type {ReactServerContext} from 'shared/ReactTypes';\nimport {REACT_SERVER_CONTEXT_TYPE} from 'shared/ReactSymbols';\nimport {readContext as readContextImpl} from './ReactFlightNewContext';\n\nlet currentRequest = null;\n\nexport function prepareToUseHooksForRequest(request: Request) {\n  currentRequest = request;\n}\n\nexport function resetHooksForRequest() {\n  currentRequest = null;\n}\n\nfunction readContext<T>(context: ReactServerContext<T>): T {\n  if (__DEV__) {\n    if (context.$$typeof !== REACT_SERVER_CONTEXT_TYPE) {\n      console.error('Only ServerContext is supported in Flight');\n    }\n    if (currentCache === null) {\n      console.error(\n        'Context can only be read while React is rendering. ' +\n          'In classes, you can read it in the render method or getDerivedStateFromProps. ' +\n          'In function components, you can read it directly in the function body, but not ' +\n          'inside Hooks like useReducer() or useMemo().',\n      );\n    }\n  }\n  return readContextImpl(context);\n}\n\nexport const Dispatcher: DispatcherType = {\n  useMemo<T>(nextCreate: () => T): T {\n    return nextCreate();\n  },\n  useCallback<T>(callback: T): T {\n    return callback;\n  },\n  useDebugValue(): void {},\n  useDeferredValue: (unsupportedHook: any),\n  useTransition: (unsupportedHook: any),\n  getCacheForType<T>(resourceType: () => T): T {\n    if (!currentCache) {\n      throw new Error('Reading the cache is only supported while rendering.');\n    }\n\n    let entry: T | void = (currentCache.get(resourceType): any);\n    if (entry === undefined) {\n      entry = resourceType();\n      // TODO: Warn if undefined?\n      currentCache.set(resourceType, entry);\n    }\n    return entry;\n  },\n  readContext,\n  useContext: readContext,\n  useReducer: (unsupportedHook: any),\n  useRef: (unsupportedHook: any),\n  useState: (unsupportedHook: any),\n  useInsertionEffect: (unsupportedHook: any),\n  useLayoutEffect: (unsupportedHook: any),\n  useImperativeHandle: (unsupportedHook: any),\n  useEffect: (unsupportedHook: any),\n  useId,\n  useMutableSource: (unsupportedHook: any),\n  useSyncExternalStore: (unsupportedHook: any),\n  useCacheRefresh(): <T>(?() => T, ?T) => void {\n    return unsupportedRefresh;\n  },\n};\n\nfunction unsupportedHook(): void {\n  throw new Error('This Hook is not supported in Server Components.');\n}\n\nfunction unsupportedRefresh(): void {\n  if (!currentCache) {\n    throw new Error(\n      'Refreshing the cache is not supported in Server Components.',\n    );\n  }\n}\n\nlet currentCache: Map<Function, mixed> | null = null;\n\nexport function setCurrentCache(cache: Map<Function, mixed> | null) {\n  currentCache = cache;\n  return currentCache;\n}\n\nexport function getCurrentCache() {\n  return currentCache;\n}\n\nfunction useId(): string {\n  if (currentRequest === null) {\n    throw new Error('useId can only be used while React is rendering');\n  }\n  const id = currentRequest.identifierCount++;\n  // use 'S' for Flight components to distinguish from 'R' and 'r' in Fizz/Client\n  return ':' + currentRequest.identifierPrefix + 'S' + id.toString(32) + ':';\n}\n","/**\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\nimport {REACT_SERVER_CONTEXT_DEFAULT_VALUE_NOT_LOADED} from 'shared/ReactSymbols';\nimport ReactSharedInternals from 'shared/ReactSharedInternals';\nimport {createServerContext} from 'react';\n\nconst ContextRegistry = ReactSharedInternals.ContextRegistry;\n\nexport function getOrCreateServerContext(globalName: string) {\n  if (!ContextRegistry[globalName]) {\n    ContextRegistry[globalName] = createServerContext(\n      globalName,\n      REACT_SERVER_CONTEXT_DEFAULT_VALUE_NOT_LOADED,\n    );\n  }\n  return ContextRegistry[globalName];\n}\n","/**\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\ndeclare function isArray(a: mixed): boolean %checks(Array.isArray(a));\n\nconst isArrayImpl = Array.isArray;\n\n// eslint-disable-next-line no-redeclare\nfunction isArray(a: mixed): boolean {\n  return isArrayImpl(a);\n}\n\nexport default isArray;\n","/**\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\nimport type {\n  Destination,\n  Chunk,\n  BundlerConfig,\n  ModuleMetaData,\n  ModuleReference,\n  ModuleKey,\n} from './ReactFlightServerConfig';\nimport type {ContextSnapshot} from './ReactFlightNewContext';\nimport type {\n  ReactProviderType,\n  ServerContextJSONValue,\n} from 'shared/ReactTypes';\n\nimport {\n  scheduleWork,\n  beginWriting,\n  writeChunkAndReturn,\n  completeWriting,\n  flushBuffered,\n  close,\n  closeWithError,\n  processModelChunk,\n  processModuleChunk,\n  processProviderChunk,\n  processSymbolChunk,\n  processErrorChunk,\n  resolveModuleMetaData,\n  getModuleKey,\n  isModuleReference,\n} from './ReactFlightServerConfig';\n\nimport {\n  Dispatcher,\n  getCurrentCache,\n  prepareToUseHooksForRequest,\n  resetHooksForRequest,\n  setCurrentCache,\n} from './ReactFlightHooks';\nimport {\n  pushProvider,\n  popProvider,\n  switchContext,\n  getActiveContext,\n  rootContextSnapshot,\n} from './ReactFlightNewContext';\n\nimport {\n  REACT_ELEMENT_TYPE,\n  REACT_FORWARD_REF_TYPE,\n  REACT_FRAGMENT_TYPE,\n  REACT_LAZY_TYPE,\n  REACT_MEMO_TYPE,\n  REACT_PROVIDER_TYPE,\n} from 'shared/ReactSymbols';\n\nimport {getOrCreateServerContext} from 'shared/ReactServerContextRegistry';\nimport ReactSharedInternals from 'shared/ReactSharedInternals';\nimport isArray from 'shared/isArray';\n\ntype ReactJSONValue =\n  | string\n  | boolean\n  | number\n  | null\n  | $ReadOnlyArray<ReactJSONValue>\n  | ReactModelObject;\n\nexport type ReactModel =\n  | React$Element<any>\n  | string\n  | boolean\n  | number\n  | null\n  | Iterable<ReactModel>\n  | ReactModelObject;\n\ntype ReactModelObject = {+[key: string]: ReactModel};\n\ntype Segment = {\n  id: number,\n  model: ReactModel,\n  ping: () => void,\n  context: ContextSnapshot,\n};\n\nexport type Request = {\n  status: 0 | 1 | 2,\n  fatalError: mixed,\n  destination: null | Destination,\n  bundlerConfig: BundlerConfig,\n  cache: Map<Function, mixed>,\n  nextChunkId: number,\n  pendingChunks: number,\n  pingedSegments: Array<Segment>,\n  completedModuleChunks: Array<Chunk>,\n  completedJSONChunks: Array<Chunk>,\n  completedErrorChunks: Array<Chunk>,\n  writtenSymbols: Map<Symbol, number>,\n  writtenModules: Map<ModuleKey, number>,\n  writtenProviders: Map<string, number>,\n  identifierPrefix: string,\n  identifierCount: number,\n  onError: (error: mixed) => void,\n  toJSON: (key: string, value: ReactModel) => ReactJSONValue,\n};\n\nconst ReactCurrentDispatcher = ReactSharedInternals.ReactCurrentDispatcher;\n\nfunction defaultErrorHandler(error: mixed) {\n  console['error'](error);\n  // Don't transform to our wrapper\n}\n\nconst OPEN = 0;\nconst CLOSING = 1;\nconst CLOSED = 2;\n\nexport function createRequest(\n  model: ReactModel,\n  bundlerConfig: BundlerConfig,\n  onError: void | ((error: mixed) => void),\n  context?: Array<[string, ServerContextJSONValue]>,\n  identifierPrefix?: string,\n): Request {\n  const pingedSegments = [];\n  const request = {\n    status: OPEN,\n    fatalError: null,\n    destination: null,\n    bundlerConfig,\n    cache: new Map(),\n    nextChunkId: 0,\n    pendingChunks: 0,\n    pingedSegments: pingedSegments,\n    completedModuleChunks: [],\n    completedJSONChunks: [],\n    completedErrorChunks: [],\n    writtenSymbols: new Map(),\n    writtenModules: new Map(),\n    writtenProviders: new Map(),\n    identifierPrefix: identifierPrefix || '',\n    identifierCount: 1,\n    onError: onError === undefined ? defaultErrorHandler : onError,\n    toJSON: function(key: string, value: ReactModel): ReactJSONValue {\n      return resolveModelToJSON(request, this, key, value);\n    },\n  };\n  request.pendingChunks++;\n  const rootContext = createRootContext(context);\n  const rootSegment = createSegment(request, model, rootContext);\n  pingedSegments.push(rootSegment);\n  return request;\n}\n\nfunction createRootContext(\n  reqContext?: Array<[string, ServerContextJSONValue]>,\n) {\n  return importServerContexts(reqContext);\n}\n\nconst POP = {};\n\nfunction attemptResolveElement(\n  type: any,\n  key: null | React$Key,\n  ref: mixed,\n  props: any,\n): ReactModel {\n  if (ref !== null && ref !== undefined) {\n    // When the ref moves to the regular props object this will implicitly\n    // throw for functions. We could probably relax it to a DEV warning for other\n    // cases.\n    throw new Error(\n      'Refs cannot be used in server components, nor passed to client components.',\n    );\n  }\n  if (typeof type === 'function') {\n    // This is a server-side component.\n    return type(props);\n  } else if (typeof type === 'string') {\n    // This is a host element. E.g. HTML.\n    return [REACT_ELEMENT_TYPE, type, key, props];\n  } else if (typeof type === 'symbol') {\n    if (type === REACT_FRAGMENT_TYPE) {\n      // For key-less fragments, we add a small optimization to avoid serializing\n      // it as a wrapper.\n      // TODO: If a key is specified, we should propagate its key to any children.\n      // Same as if a server component has a key.\n      return props.children;\n    }\n    // This might be a built-in React component. We'll let the client decide.\n    // Any built-in works as long as its props are serializable.\n    return [REACT_ELEMENT_TYPE, type, key, props];\n  } else if (type != null && typeof type === 'object') {\n    if (isModuleReference(type)) {\n      // This is a reference to a client component.\n      return [REACT_ELEMENT_TYPE, type, key, props];\n    }\n    switch (type.$$typeof) {\n      case REACT_LAZY_TYPE: {\n        const payload = type._payload;\n        const init = type._init;\n        const wrappedType = init(payload);\n        return attemptResolveElement(wrappedType, key, ref, props);\n      }\n      case REACT_FORWARD_REF_TYPE: {\n        const render = type.render;\n        return render(props, undefined);\n      }\n      case REACT_MEMO_TYPE: {\n        return attemptResolveElement(type.type, key, ref, props);\n      }\n      case REACT_PROVIDER_TYPE: {\n        pushProvider(type._context, props.value);\n        if (__DEV__) {\n          const extraKeys = Object.keys(props).filter(value => {\n            if (value === 'children' || value === 'value') {\n              return false;\n            }\n            return true;\n          });\n          if (extraKeys.length !== 0) {\n            console.error(\n              'ServerContext can only have a value prop and children. Found: %s',\n              JSON.stringify(extraKeys),\n            );\n          }\n        }\n        return [\n          REACT_ELEMENT_TYPE,\n          type,\n          key,\n          // Rely on __popProvider being serialized last to pop the provider.\n          {value: props.value, children: props.children, __pop: POP},\n        ];\n      }\n    }\n  }\n  throw new Error(\n    `Unsupported server component type: ${describeValueForErrorMessage(type)}`,\n  );\n}\n\nfunction pingSegment(request: Request, segment: Segment): void {\n  const pingedSegments = request.pingedSegments;\n  pingedSegments.push(segment);\n  if (pingedSegments.length === 1) {\n    scheduleWork(() => performWork(request));\n  }\n}\n\nfunction createSegment(\n  request: Request,\n  model: ReactModel,\n  context: ContextSnapshot,\n): Segment {\n  const id = request.nextChunkId++;\n  const segment = {\n    id,\n    model,\n    context,\n    ping: () => pingSegment(request, segment),\n  };\n  return segment;\n}\n\nfunction serializeByValueID(id: number): string {\n  return '$' + id.toString(16);\n}\n\nfunction serializeByRefID(id: number): string {\n  return '@' + id.toString(16);\n}\n\nfunction escapeStringValue(value: string): string {\n  if (value[0] === '$' || value[0] === '@') {\n    // We need to escape $ or @ prefixed strings since we use those to encode\n    // references to IDs and as special symbol values.\n    return '$' + value;\n  } else {\n    return value;\n  }\n}\n\nfunction isObjectPrototype(object): boolean {\n  if (!object) {\n    return false;\n  }\n  const ObjectPrototype = Object.prototype;\n  if (object === ObjectPrototype) {\n    return true;\n  }\n  // It might be an object from a different Realm which is\n  // still just a plain simple object.\n  if (Object.getPrototypeOf(object)) {\n    return false;\n  }\n  const names = Object.getOwnPropertyNames(object);\n  for (let i = 0; i < names.length; i++) {\n    if (!(names[i] in ObjectPrototype)) {\n      return false;\n    }\n  }\n  return true;\n}\n\nfunction isSimpleObject(object): boolean {\n  if (!isObjectPrototype(Object.getPrototypeOf(object))) {\n    return false;\n  }\n  const names = Object.getOwnPropertyNames(object);\n  for (let i = 0; i < names.length; i++) {\n    const descriptor = Object.getOwnPropertyDescriptor(object, names[i]);\n    if (!descriptor) {\n      return false;\n    }\n    if (!descriptor.enumerable) {\n      if (\n        (names[i] === 'key' || names[i] === 'ref') &&\n        typeof descriptor.get === 'function'\n      ) {\n        // React adds key and ref getters to props objects to issue warnings.\n        // Those getters will not be transferred to the client, but that's ok,\n        // so we'll special case them.\n        continue;\n      }\n      return false;\n    }\n  }\n  return true;\n}\n\nfunction objectName(object): string {\n  const name = Object.prototype.toString.call(object);\n  return name.replace(/^\\[object (.*)\\]$/, function(m, p0) {\n    return p0;\n  });\n}\n\nfunction describeKeyForErrorMessage(key: string): string {\n  const encodedKey = JSON.stringify(key);\n  return '\"' + key + '\"' === encodedKey ? key : encodedKey;\n}\n\nfunction describeValueForErrorMessage(value: ReactModel): string {\n  switch (typeof value) {\n    case 'string': {\n      return JSON.stringify(\n        value.length <= 10 ? value : value.substr(0, 10) + '...',\n      );\n    }\n    case 'object': {\n      if (isArray(value)) {\n        return '[...]';\n      }\n      const name = objectName(value);\n      if (name === 'Object') {\n        return '{...}';\n      }\n      return name;\n    }\n    case 'function':\n      return 'function';\n    default:\n      // eslint-disable-next-line react-internal/safe-string-coercion\n      return String(value);\n  }\n}\n\nfunction describeObjectForErrorMessage(\n  objectOrArray:\n    | {+[key: string | number]: ReactModel}\n    | $ReadOnlyArray<ReactModel>,\n  expandedName?: string,\n): string {\n  if (isArray(objectOrArray)) {\n    let str = '[';\n    const array: $ReadOnlyArray<ReactModel> = objectOrArray;\n    for (let i = 0; i < array.length; i++) {\n      if (i > 0) {\n        str += ', ';\n      }\n      if (i > 6) {\n        str += '...';\n        break;\n      }\n      const value = array[i];\n      if (\n        '' + i === expandedName &&\n        typeof value === 'object' &&\n        value !== null\n      ) {\n        str += describeObjectForErrorMessage(value);\n      } else {\n        str += describeValueForErrorMessage(value);\n      }\n    }\n    str += ']';\n    return str;\n  } else {\n    let str = '{';\n    const object: {+[key: string | number]: ReactModel} = objectOrArray;\n    const names = Object.keys(object);\n    for (let i = 0; i < names.length; i++) {\n      if (i > 0) {\n        str += ', ';\n      }\n      if (i > 6) {\n        str += '...';\n        break;\n      }\n      const name = names[i];\n      str += describeKeyForErrorMessage(name) + ': ';\n      const value = object[name];\n      if (\n        name === expandedName &&\n        typeof value === 'object' &&\n        value !== null\n      ) {\n        str += describeObjectForErrorMessage(value);\n      } else {\n        str += describeValueForErrorMessage(value);\n      }\n    }\n    str += '}';\n    return str;\n  }\n}\n\nlet insideContextProps = null;\nlet isInsideContextValue = false;\n\nexport function resolveModelToJSON(\n  request: Request,\n  parent: {+[key: string | number]: ReactModel} | $ReadOnlyArray<ReactModel>,\n  key: string,\n  value: ReactModel,\n): ReactJSONValue {\n  if (__DEV__) {\n    // $FlowFixMe\n    const originalValue = parent[key];\n    if (typeof originalValue === 'object' && originalValue !== value) {\n      console.error(\n        'Only plain objects can be passed to client components from server components. ' +\n          'Objects with toJSON methods are not supported. Convert it manually ' +\n          'to a simple value before passing it to props. ' +\n          'Remove %s from these props: %s',\n        describeKeyForErrorMessage(key),\n        describeObjectForErrorMessage(parent),\n      );\n    }\n  }\n\n  // Special Symbols\n  switch (value) {\n    case REACT_ELEMENT_TYPE:\n      return '$';\n  }\n\n  if (__DEV__) {\n    if (\n      parent[0] === REACT_ELEMENT_TYPE &&\n      parent[1] &&\n      parent[1].$$typeof === REACT_PROVIDER_TYPE &&\n      key === '3'\n    ) {\n      insideContextProps = value;\n    } else if (insideContextProps === parent && key === 'value') {\n      isInsideContextValue = true;\n    } else if (insideContextProps === parent && key === 'children') {\n      isInsideContextValue = false;\n    }\n  }\n\n  // Resolve server components.\n  while (\n    typeof value === 'object' &&\n    value !== null &&\n    ((value: any).$$typeof === REACT_ELEMENT_TYPE ||\n      (value: any).$$typeof === REACT_LAZY_TYPE)\n  ) {\n    if (__DEV__) {\n      if (isInsideContextValue) {\n        console.error('React elements are not allowed in ServerContext');\n      }\n    }\n\n    try {\n      switch ((value: any).$$typeof) {\n        case REACT_ELEMENT_TYPE: {\n          // TODO: Concatenate keys of parents onto children.\n          const element: React$Element<any> = (value: any);\n          // Attempt to render the server component.\n          value = attemptResolveElement(\n            element.type,\n            element.key,\n            element.ref,\n            element.props,\n          );\n          break;\n        }\n        case REACT_LAZY_TYPE: {\n          const payload = (value: any)._payload;\n          const init = (value: any)._init;\n          value = init(payload);\n          break;\n        }\n      }\n    } catch (x) {\n      if (typeof x === 'object' && x !== null && typeof x.then === 'function') {\n        // Something suspended, we'll need to create a new segment and resolve it later.\n        request.pendingChunks++;\n        const newSegment = createSegment(request, value, getActiveContext());\n        const ping = newSegment.ping;\n        x.then(ping, ping);\n        return serializeByRefID(newSegment.id);\n      } else {\n        logRecoverableError(request, x);\n        // Something errored. We'll still send everything we have up until this point.\n        // We'll replace this element with a lazy reference that throws on the client\n        // once it gets rendered.\n        request.pendingChunks++;\n        const errorId = request.nextChunkId++;\n        emitErrorChunk(request, errorId, x);\n        return serializeByRefID(errorId);\n      }\n    }\n  }\n\n  if (value === null) {\n    return null;\n  }\n\n  if (typeof value === 'object') {\n    if (isModuleReference(value)) {\n      const moduleReference: ModuleReference<any> = (value: any);\n      const moduleKey: ModuleKey = getModuleKey(moduleReference);\n      const writtenModules = request.writtenModules;\n      const existingId = writtenModules.get(moduleKey);\n      if (existingId !== undefined) {\n        if (parent[0] === REACT_ELEMENT_TYPE && key === '1') {\n          // If we're encoding the \"type\" of an element, we can refer\n          // to that by a lazy reference instead of directly since React\n          // knows how to deal with lazy values. This lets us suspend\n          // on this component rather than its parent until the code has\n          // loaded.\n          return serializeByRefID(existingId);\n        }\n        return serializeByValueID(existingId);\n      }\n      try {\n        const moduleMetaData: ModuleMetaData = resolveModuleMetaData(\n          request.bundlerConfig,\n          moduleReference,\n        );\n        request.pendingChunks++;\n        const moduleId = request.nextChunkId++;\n        emitModuleChunk(request, moduleId, moduleMetaData);\n        writtenModules.set(moduleKey, moduleId);\n        if (parent[0] === REACT_ELEMENT_TYPE && key === '1') {\n          // If we're encoding the \"type\" of an element, we can refer\n          // to that by a lazy reference instead of directly since React\n          // knows how to deal with lazy values. This lets us suspend\n          // on this component rather than its parent until the code has\n          // loaded.\n          return serializeByRefID(moduleId);\n        }\n        return serializeByValueID(moduleId);\n      } catch (x) {\n        request.pendingChunks++;\n        const errorId = request.nextChunkId++;\n        emitErrorChunk(request, errorId, x);\n        return serializeByValueID(errorId);\n      }\n    } else if ((value: any).$$typeof === REACT_PROVIDER_TYPE) {\n      const providerKey = ((value: any): ReactProviderType<any>)._context\n        ._globalName;\n      const writtenProviders = request.writtenProviders;\n      let providerId = writtenProviders.get(key);\n      if (providerId === undefined) {\n        request.pendingChunks++;\n        providerId = request.nextChunkId++;\n        writtenProviders.set(providerKey, providerId);\n        emitProviderChunk(request, providerId, providerKey);\n      }\n      return serializeByValueID(providerId);\n    } else if (value === POP) {\n      popProvider();\n      if (__DEV__) {\n        insideContextProps = null;\n        isInsideContextValue = false;\n      }\n      return (undefined: any);\n    }\n\n    if (__DEV__) {\n      if (value !== null && !isArray(value)) {\n        // Verify that this is a simple plain object.\n        if (objectName(value) !== 'Object') {\n          console.error(\n            'Only plain objects can be passed to client components from server components. ' +\n              'Built-ins like %s are not supported. ' +\n              'Remove %s from these props: %s',\n            objectName(value),\n            describeKeyForErrorMessage(key),\n            describeObjectForErrorMessage(parent),\n          );\n        } else if (!isSimpleObject(value)) {\n          console.error(\n            'Only plain objects can be passed to client components from server components. ' +\n              'Classes or other objects with methods are not supported. ' +\n              'Remove %s from these props: %s',\n            describeKeyForErrorMessage(key),\n            describeObjectForErrorMessage(parent, key),\n          );\n        } else if (Object.getOwnPropertySymbols) {\n          const symbols = Object.getOwnPropertySymbols(value);\n          if (symbols.length > 0) {\n            console.error(\n              'Only plain objects can be passed to client components from server components. ' +\n                'Objects with symbol properties like %s are not supported. ' +\n                'Remove %s from these props: %s',\n              symbols[0].description,\n              describeKeyForErrorMessage(key),\n              describeObjectForErrorMessage(parent, key),\n            );\n          }\n        }\n      }\n    }\n\n    return value;\n  }\n\n  if (typeof value === 'string') {\n    return escapeStringValue(value);\n  }\n\n  if (\n    typeof value === 'boolean' ||\n    typeof value === 'number' ||\n    typeof value === 'undefined'\n  ) {\n    return value;\n  }\n\n  if (typeof value === 'function') {\n    if (/^on[A-Z]/.test(key)) {\n      throw new Error(\n        'Event handlers cannot be passed to client component props. ' +\n          `Remove ${describeKeyForErrorMessage(\n            key,\n          )} from these props if possible: ${describeObjectForErrorMessage(\n            parent,\n          )}\n` +\n          'If you need interactivity, consider converting part of this to a client component.',\n      );\n    } else {\n      throw new Error(\n        'Functions cannot be passed directly to client components ' +\n          \"because they're not serializable. \" +\n          `Remove ${describeKeyForErrorMessage(key)} (${value.displayName ||\n            value.name ||\n            'function'}) from this object, or avoid the entire object: ${describeObjectForErrorMessage(\n            parent,\n          )}`,\n      );\n    }\n  }\n\n  if (typeof value === 'symbol') {\n    const writtenSymbols = request.writtenSymbols;\n    const existingId = writtenSymbols.get(value);\n    if (existingId !== undefined) {\n      return serializeByValueID(existingId);\n    }\n    const name = value.description;\n\n    if (Symbol.for(name) !== value) {\n      throw new Error(\n        'Only global symbols received from Symbol.for(...) can be passed to client components. ' +\n          `The symbol Symbol.for(${value.description}) cannot be found among global symbols. ` +\n          `Remove ${describeKeyForErrorMessage(\n            key,\n          )} from this object, or avoid the entire object: ${describeObjectForErrorMessage(\n            parent,\n          )}`,\n      );\n    }\n\n    request.pendingChunks++;\n    const symbolId = request.nextChunkId++;\n    emitSymbolChunk(request, symbolId, name);\n    writtenSymbols.set(value, symbolId);\n    return serializeByValueID(symbolId);\n  }\n\n  // $FlowFixMe: bigint isn't added to Flow yet.\n  if (typeof value === 'bigint') {\n    throw new Error(\n      `BigInt (${value}) is not yet supported in client component props. ` +\n        `Remove ${describeKeyForErrorMessage(\n          key,\n        )} from this object or use a plain number instead: ${describeObjectForErrorMessage(\n          parent,\n        )}`,\n    );\n  }\n\n  throw new Error(\n    `Type ${typeof value} is not supported in client component props. ` +\n      `Remove ${describeKeyForErrorMessage(\n        key,\n      )} from this object, or avoid the entire object: ${describeObjectForErrorMessage(\n        parent,\n      )}`,\n  );\n}\n\nfunction logRecoverableError(request: Request, error: mixed): void {\n  const onError = request.onError;\n  onError(error);\n}\n\nfunction fatalError(request: Request, error: mixed): void {\n  // This is called outside error handling code such as if an error happens in React internals.\n  if (request.destination !== null) {\n    request.status = CLOSED;\n    closeWithError(request.destination, error);\n  } else {\n    request.status = CLOSING;\n    request.fatalError = error;\n  }\n}\n\nfunction emitErrorChunk(request: Request, id: number, error: mixed): void {\n  // TODO: We should not leak error messages to the client in prod.\n  // Give this an error code instead and log on the server.\n  // We can serialize the error in DEV as a convenience.\n  let message;\n  let stack = '';\n  try {\n    if (error instanceof Error) {\n      // eslint-disable-next-line react-internal/safe-string-coercion\n      message = String(error.message);\n      // eslint-disable-next-line react-internal/safe-string-coercion\n      stack = String(error.stack);\n    } else {\n      message = 'Error: ' + (error: any);\n    }\n  } catch (x) {\n    message = 'An error occurred but serializing the error message failed.';\n  }\n\n  const processedChunk = processErrorChunk(request, id, message, stack);\n  request.completedErrorChunks.push(processedChunk);\n}\n\nfunction emitModuleChunk(\n  request: Request,\n  id: number,\n  moduleMetaData: ModuleMetaData,\n): void {\n  const processedChunk = processModuleChunk(request, id, moduleMetaData);\n  request.completedModuleChunks.push(processedChunk);\n}\n\nfunction emitSymbolChunk(request: Request, id: number, name: string): void {\n  const processedChunk = processSymbolChunk(request, id, name);\n  request.completedModuleChunks.push(processedChunk);\n}\n\nfunction emitProviderChunk(\n  request: Request,\n  id: number,\n  contextName: string,\n): void {\n  const processedChunk = processProviderChunk(request, id, contextName);\n  request.completedJSONChunks.push(processedChunk);\n}\n\nfunction retrySegment(request: Request, segment: Segment): void {\n  switchContext(segment.context);\n  try {\n    let value = segment.model;\n    while (\n      typeof value === 'object' &&\n      value !== null &&\n      (value: any).$$typeof === REACT_ELEMENT_TYPE\n    ) {\n      // TODO: Concatenate keys of parents onto children.\n      const element: React$Element<any> = (value: any);\n      // Attempt to render the server component.\n      // Doing this here lets us reuse this same segment if the next component\n      // also suspends.\n      segment.model = value;\n      value = attemptResolveElement(\n        element.type,\n        element.key,\n        element.ref,\n        element.props,\n      );\n    }\n    const processedChunk = processModelChunk(request, segment.id, value);\n    request.completedJSONChunks.push(processedChunk);\n  } catch (x) {\n    if (typeof x === 'object' && x !== null && typeof x.then === 'function') {\n      // Something suspended again, let's pick it back up later.\n      const ping = segment.ping;\n      x.then(ping, ping);\n      return;\n    } else {\n      logRecoverableError(request, x);\n      // This errored, we need to serialize this error to the\n      emitErrorChunk(request, segment.id, x);\n    }\n  }\n}\n\nfunction performWork(request: Request): void {\n  const prevDispatcher = ReactCurrentDispatcher.current;\n  const prevCache = getCurrentCache();\n  ReactCurrentDispatcher.current = Dispatcher;\n  setCurrentCache(request.cache);\n  prepareToUseHooksForRequest(request);\n\n  try {\n    const pingedSegments = request.pingedSegments;\n    request.pingedSegments = [];\n    for (let i = 0; i < pingedSegments.length; i++) {\n      const segment = pingedSegments[i];\n      retrySegment(request, segment);\n    }\n    if (request.destination !== null) {\n      flushCompletedChunks(request, request.destination);\n    }\n  } catch (error) {\n    logRecoverableError(request, error);\n    fatalError(request, error);\n  } finally {\n    ReactCurrentDispatcher.current = prevDispatcher;\n    setCurrentCache(prevCache);\n    resetHooksForRequest();\n  }\n}\n\nfunction flushCompletedChunks(\n  request: Request,\n  destination: Destination,\n): void {\n  beginWriting(destination);\n  try {\n    // We emit module chunks first in the stream so that\n    // they can be preloaded as early as possible.\n    const moduleChunks = request.completedModuleChunks;\n    let i = 0;\n    for (; i < moduleChunks.length; i++) {\n      request.pendingChunks--;\n      const chunk = moduleChunks[i];\n      const keepWriting: boolean = writeChunkAndReturn(destination, chunk);\n      if (!keepWriting) {\n        request.destination = null;\n        i++;\n        break;\n      }\n    }\n    moduleChunks.splice(0, i);\n    // Next comes model data.\n    const jsonChunks = request.completedJSONChunks;\n    i = 0;\n    for (; i < jsonChunks.length; i++) {\n      request.pendingChunks--;\n      const chunk = jsonChunks[i];\n      const keepWriting: boolean = writeChunkAndReturn(destination, chunk);\n      if (!keepWriting) {\n        request.destination = null;\n        i++;\n        break;\n      }\n    }\n    jsonChunks.splice(0, i);\n    // Finally, errors are sent. The idea is that it's ok to delay\n    // any error messages and prioritize display of other parts of\n    // the page.\n    const errorChunks = request.completedErrorChunks;\n    i = 0;\n    for (; i < errorChunks.length; i++) {\n      request.pendingChunks--;\n      const chunk = errorChunks[i];\n      const keepWriting: boolean = writeChunkAndReturn(destination, chunk);\n      if (!keepWriting) {\n        request.destination = null;\n        i++;\n        break;\n      }\n    }\n    errorChunks.splice(0, i);\n  } finally {\n    completeWriting(destination);\n  }\n  flushBuffered(destination);\n  if (request.pendingChunks === 0) {\n    // We're done.\n    close(destination);\n  }\n}\n\nexport function startWork(request: Request): void {\n  scheduleWork(() => performWork(request));\n}\n\nexport function startFlowing(request: Request, destination: Destination): void {\n  if (request.status === CLOSING) {\n    request.status = CLOSED;\n    closeWithError(destination, request.fatalError);\n    return;\n  }\n  if (request.status === CLOSED) {\n    return;\n  }\n  if (request.destination !== null) {\n    // We're already flowing.\n    return;\n  }\n  request.destination = destination;\n  try {\n    flushCompletedChunks(request, destination);\n  } catch (error) {\n    logRecoverableError(request, error);\n    fatalError(request, error);\n  }\n}\n\nfunction importServerContexts(\n  contexts?: Array<[string, ServerContextJSONValue]>,\n) {\n  if (contexts) {\n    const prevContext = getActiveContext();\n    switchContext(rootContextSnapshot);\n    for (let i = 0; i < contexts.length; i++) {\n      const [name, value] = contexts[i];\n      const context = getOrCreateServerContext(name);\n      pushProvider(context, value);\n    }\n    const importedContext = getActiveContext();\n    switchContext(prevContext);\n    return importedContext;\n  }\n  return rootContextSnapshot;\n}\n"],"names":["ReactSharedInternals","React","error","format","args","printWarning","level","ReactDebugCurrentFrame","stack","getStackAddendum","concat","argsWithFormat","map","item","String","unshift","Function","prototype","apply","call","console","scheduleWork","$$$hostConfig","beginWriting","writeChunk","writeChunkAndReturn","completeWriting","flushBuffered","close","closeWithError","stringToChunk","stringToPrecomputedChunk","stringify","JSON","serializeRowHeader","tag","id","toString","processErrorChunk","request","message","errorInfo","row","processModelChunk","model","json","toJSON","processModuleChunk","moduleMetaData","processProviderChunk","contextName","processSymbolChunk","name","isModuleReference","getModuleKey","resolveModuleMetaData","REACT_ELEMENT_TYPE","Symbol","for","REACT_FRAGMENT_TYPE","REACT_PROVIDER_TYPE","REACT_SERVER_CONTEXT_TYPE","REACT_FORWARD_REF_TYPE","REACT_MEMO_TYPE","REACT_LAZY_TYPE","REACT_SERVER_CONTEXT_DEFAULT_VALUE_NOT_LOADED","getChildFormatContext","UNINITIALIZED_SUSPENSE_BOUNDARY_ID","assignSuspenseBoundaryID","makeId","pushTextInstance","pushStartInstance","pushEndInstance","pushStartCompletedSuspenseBoundary","pushEndCompletedSuspenseBoundary","pushSegmentFinale","writeCompletedRoot","writePlaceholder","writeStartCompletedSuspenseBoundary","writeStartPendingSuspenseBoundary","writeStartClientRenderedSuspenseBoundary","writeEndCompletedSuspenseBoundary","writeEndPendingSuspenseBoundary","writeEndClientRenderedSuspenseBoundary","writeStartSegment","writeEndSegment","writeCompletedSegmentInstruction","writeCompletedBoundaryInstruction","writeClientRenderBoundaryInstruction","rendererSigil","rootContextSnapshot","currentActiveSnapshot","popNode","prev","context","_currentValue2","parentValue","pushNode","next","value","popToNearestCommonAncestor","parentPrev","parent","parentNext","Error","popAllPrevious","pushAllNext","popPreviousToCommonLevel","depth","popNextToCommonLevel","switchContext","newSnapshot","pushProvider","nextValue","prevValue","_currentRenderer2","undefined","prevNode","newNode","popProvider","prevSnapshot","_defaultValue","getActiveContext","readContext","isPrimaryRenderer","currentRequest","prepareToUseHooksForRequest","resetHooksForRequest","$$typeof","currentCache","readContextImpl","Dispatcher","useMemo","nextCreate","useCallback","callback","useDebugValue","useDeferredValue","unsupportedHook","useTransition","getCacheForType","resourceType","entry","get","set","useContext","useReducer","useRef","useState","useInsertionEffect","useLayoutEffect","useImperativeHandle","useEffect","useId","useMutableSource","useSyncExternalStore","useCacheRefresh","unsupportedRefresh","setCurrentCache","cache","getCurrentCache","identifierCount","identifierPrefix","ContextRegistry","getOrCreateServerContext","globalName","createServerContext","isArrayImpl","Array","isArray","a","ReactCurrentDispatcher","defaultErrorHandler","OPEN","CLOSING","CLOSED","createRequest","bundlerConfig","onError","pingedSegments","status","fatalError","destination","Map","nextChunkId","pendingChunks","completedModuleChunks","completedJSONChunks","completedErrorChunks","writtenSymbols","writtenModules","writtenProviders","key","resolveModelToJSON","rootContext","createRootContext","rootSegment","createSegment","push","reqContext","importServerContexts","POP","attemptResolveElement","type","ref","props","children","payload","_payload","init","_init","wrappedType","render","_context","extraKeys","Object","keys","filter","length","__pop","describeValueForErrorMessage","pingSegment","segment","performWork","ping","serializeByValueID","serializeByRefID","escapeStringValue","isObjectPrototype","object","ObjectPrototype","getPrototypeOf","names","getOwnPropertyNames","i","isSimpleObject","descriptor","getOwnPropertyDescriptor","enumerable","objectName","replace","m","p0","describeKeyForErrorMessage","encodedKey","substr","describeObjectForErrorMessage","objectOrArray","expandedName","str","array","insideContextProps","isInsideContextValue","originalValue","element","x","then","newSegment","logRecoverableError","errorId","emitErrorChunk","moduleReference","moduleKey","existingId","moduleId","emitModuleChunk","providerKey","_globalName","providerId","emitProviderChunk","getOwnPropertySymbols","symbols","description","test","displayName","symbolId","emitSymbolChunk","processedChunk","retrySegment","prevDispatcher","current","prevCache","flushCompletedChunks","moduleChunks","chunk","keepWriting","splice","jsonChunks","errorChunks","startWork","startFlowing","contexts","prevContext","importedContext"],"mappings":"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"}