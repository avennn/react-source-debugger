{"version":3,"file":"react-server-dom-webpack.development.js","sources":["../../../../packages/react-client/src/ReactFlightClientHostConfigBrowser.js","../../../../packages/react-client/src/ReactFlightClientHostConfigStream.js","../../../../packages/react-server-dom-webpack/src/ReactFlightClientWebpackBundlerConfig.js","../../../../packages/shared/ReactSymbols.js","../../../../packages/shared/ReactSharedInternals.js","../../../../packages/shared/ReactServerContextRegistry.js","../../../../packages/react-client/src/ReactFlightClient.js","../../../../packages/react-client/src/ReactFlightClientStream.js","../../../../packages/react-server-dom-webpack/src/ReactFlightDOMClient.js"],"sourcesContent":["/**\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\nexport type StringDecoder = TextDecoder;\n\nexport const supportsBinaryStreams = true;\n\nexport function createStringDecoder(): StringDecoder {\n  return new TextDecoder();\n}\n\nconst decoderOptions = {stream: true};\n\nexport function readPartialStringChunk(\n  decoder: StringDecoder,\n  buffer: Uint8Array,\n): string {\n  return decoder.decode(buffer, decoderOptions);\n}\n\nexport function readFinalStringChunk(\n  decoder: StringDecoder,\n  buffer: Uint8Array,\n): string {\n  return decoder.decode(buffer);\n}\n","/**\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\nimport type {ResponseBase} from './ReactFlightClient';\nimport type {StringDecoder} from './ReactFlightClientHostConfig';\n\nexport type Response = ResponseBase & {\n  _partialRow: string,\n  _fromJSON: (key: string, value: JSONValue) => any,\n  _stringDecoder: StringDecoder,\n};\n\nexport type UninitializedModel = string;\n\nexport function parseModel<T>(response: Response, json: UninitializedModel): T {\n  return JSON.parse(json, response._fromJSON);\n}\n","/**\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\nexport type WebpackSSRMap = {\n  [clientId: string]: {\n    [clientExportName: string]: ModuleMetaData,\n  },\n};\n\nexport type BundlerConfig = null | WebpackSSRMap;\n\nexport opaque type ModuleMetaData = {\n  id: string,\n  chunks: Array<string>,\n  name: string,\n};\n\n// eslint-disable-next-line no-unused-vars\nexport opaque type ModuleReference<T> = ModuleMetaData;\n\nexport function resolveModuleReference<T>(\n  bundlerConfig: BundlerConfig,\n  moduleData: ModuleMetaData,\n): ModuleReference<T> {\n  if (bundlerConfig) {\n    return bundlerConfig[moduleData.id][moduleData.name];\n  }\n  return moduleData;\n}\n\n// The chunk cache contains all the chunks we've preloaded so far.\n// If they're still pending they're a thenable. This map also exists\n// in Webpack but unfortunately it's not exposed so we have to\n// replicate it in user space. null means that it has already loaded.\nconst chunkCache: Map<string, null | Promise<any> | Error> = new Map();\n\n// Start preloading the modules since we might need them soon.\n// This function doesn't suspend.\nexport function preloadModule<T>(moduleData: ModuleReference<T>): void {\n  const chunks = moduleData.chunks;\n  for (let i = 0; i < chunks.length; i++) {\n    const chunkId = chunks[i];\n    const entry = chunkCache.get(chunkId);\n    if (entry === undefined) {\n      const thenable = __webpack_chunk_load__(chunkId);\n      const resolve = chunkCache.set.bind(chunkCache, chunkId, null);\n      const reject = chunkCache.set.bind(chunkCache, chunkId);\n      thenable.then(resolve, reject);\n      chunkCache.set(chunkId, thenable);\n    }\n  }\n}\n\n// Actually require the module or suspend if it's not yet ready.\n// Increase priority if necessary.\nexport function requireModule<T>(moduleData: ModuleReference<T>): T {\n  const chunks = moduleData.chunks;\n  for (let i = 0; i < chunks.length; i++) {\n    const chunkId = chunks[i];\n    const entry = chunkCache.get(chunkId);\n    if (entry !== null) {\n      // We assume that preloadModule has been called before.\n      // So we don't expect to see entry being undefined here, that's an error.\n      // Let's throw either an error or the Promise.\n      throw entry;\n    }\n  }\n  const moduleExports = __webpack_require__(moduleData.id);\n  if (moduleData.name === '*') {\n    // This is a placeholder value that represents that the caller imported this\n    // as a CommonJS module as is.\n    return moduleExports;\n  }\n  if (moduleData.name === '') {\n    // This is a placeholder value that represents that the caller accessed the\n    // default property of this if it was an ESM interop module.\n    return moduleExports.__esModule ? moduleExports.default : moduleExports;\n  }\n  return moduleExports[moduleData.name];\n}\n","/**\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\n// ATTENTION\n// When adding new symbols to this file,\n// Please consider also adding to 'react-devtools-shared/src/backend/ReactSymbols'\n\n// The Symbol used to tag the ReactElement-like types.\nexport const REACT_ELEMENT_TYPE = Symbol.for('react.element');\nexport const REACT_PORTAL_TYPE = Symbol.for('react.portal');\nexport const REACT_FRAGMENT_TYPE = Symbol.for('react.fragment');\nexport const REACT_STRICT_MODE_TYPE = Symbol.for('react.strict_mode');\nexport const REACT_PROFILER_TYPE = Symbol.for('react.profiler');\nexport const REACT_PROVIDER_TYPE = Symbol.for('react.provider');\nexport const REACT_CONTEXT_TYPE = Symbol.for('react.context');\nexport const REACT_SERVER_CONTEXT_TYPE = Symbol.for('react.server_context');\nexport const REACT_FORWARD_REF_TYPE = Symbol.for('react.forward_ref');\nexport const REACT_SUSPENSE_TYPE = Symbol.for('react.suspense');\nexport const REACT_SUSPENSE_LIST_TYPE = Symbol.for('react.suspense_list');\nexport const REACT_MEMO_TYPE = Symbol.for('react.memo');\nexport const REACT_LAZY_TYPE = Symbol.for('react.lazy');\nexport const REACT_SCOPE_TYPE = Symbol.for('react.scope');\nexport const REACT_DEBUG_TRACING_MODE_TYPE = Symbol.for(\n  'react.debug_trace_mode',\n);\nexport const REACT_OFFSCREEN_TYPE = Symbol.for('react.offscreen');\nexport const REACT_LEGACY_HIDDEN_TYPE = Symbol.for('react.legacy_hidden');\nexport const REACT_CACHE_TYPE = Symbol.for('react.cache');\nexport const REACT_TRACING_MARKER_TYPE = Symbol.for('react.tracing_marker');\nexport const REACT_SERVER_CONTEXT_DEFAULT_VALUE_NOT_LOADED = Symbol.for(\n  'react.default_value',\n);\n\nconst MAYBE_ITERATOR_SYMBOL = Symbol.iterator;\nconst FAUX_ITERATOR_SYMBOL = '@@iterator';\n\nexport function getIteratorFn(maybeIterable: ?any): ?() => ?Iterator<*> {\n  if (maybeIterable === null || typeof maybeIterable !== 'object') {\n    return null;\n  }\n  const maybeIterator =\n    (MAYBE_ITERATOR_SYMBOL && maybeIterable[MAYBE_ITERATOR_SYMBOL]) ||\n    maybeIterable[FAUX_ITERATOR_SYMBOL];\n  if (typeof maybeIterator === 'function') {\n    return maybeIterator;\n  }\n  return null;\n}\n","/**\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\nimport * as React from 'react';\n\nconst ReactSharedInternals =\n  React.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;\n\nexport default ReactSharedInternals;\n","/**\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\nimport {REACT_SERVER_CONTEXT_DEFAULT_VALUE_NOT_LOADED} from 'shared/ReactSymbols';\nimport ReactSharedInternals from 'shared/ReactSharedInternals';\nimport {createServerContext} from 'react';\n\nconst ContextRegistry = ReactSharedInternals.ContextRegistry;\n\nexport function getOrCreateServerContext(globalName: string) {\n  if (!ContextRegistry[globalName]) {\n    ContextRegistry[globalName] = createServerContext(\n      globalName,\n      REACT_SERVER_CONTEXT_DEFAULT_VALUE_NOT_LOADED,\n    );\n  }\n  return ContextRegistry[globalName];\n}\n","/**\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\nimport type {Wakeable} from 'shared/ReactTypes';\nimport type {LazyComponent} from 'react/src/ReactLazy';\n\nimport type {\n  ModuleReference,\n  ModuleMetaData,\n  UninitializedModel,\n  Response,\n  BundlerConfig,\n} from './ReactFlightClientHostConfig';\n\nimport {\n  resolveModuleReference,\n  preloadModule,\n  requireModule,\n  parseModel,\n} from './ReactFlightClientHostConfig';\n\nimport {REACT_LAZY_TYPE, REACT_ELEMENT_TYPE} from 'shared/ReactSymbols';\n\nimport {getOrCreateServerContext} from 'shared/ReactServerContextRegistry';\n\nexport type JSONValue =\n  | number\n  | null\n  | boolean\n  | string\n  | {+[key: string]: JSONValue}\n  | $ReadOnlyArray<JSONValue>;\n\nconst PENDING = 0;\nconst RESOLVED_MODEL = 1;\nconst RESOLVED_MODULE = 2;\nconst INITIALIZED = 3;\nconst ERRORED = 4;\n\ntype PendingChunk = {\n  _status: 0,\n  _value: null | Array<() => mixed>,\n  _response: Response,\n  then(resolve: () => mixed): void,\n};\ntype ResolvedModelChunk = {\n  _status: 1,\n  _value: UninitializedModel,\n  _response: Response,\n  then(resolve: () => mixed): void,\n};\ntype ResolvedModuleChunk<T> = {\n  _status: 2,\n  _value: ModuleReference<T>,\n  _response: Response,\n  then(resolve: () => mixed): void,\n};\ntype InitializedChunk<T> = {\n  _status: 3,\n  _value: T,\n  _response: Response,\n  then(resolve: () => mixed): void,\n};\ntype ErroredChunk = {\n  _status: 4,\n  _value: Error,\n  _response: Response,\n  then(resolve: () => mixed): void,\n};\ntype SomeChunk<T> =\n  | PendingChunk\n  | ResolvedModelChunk\n  | ResolvedModuleChunk<T>\n  | InitializedChunk<T>\n  | ErroredChunk;\n\nfunction Chunk(status: any, value: any, response: Response) {\n  this._status = status;\n  this._value = value;\n  this._response = response;\n}\nChunk.prototype.then = function<T>(resolve: () => mixed) {\n  const chunk: SomeChunk<T> = this;\n  if (chunk._status === PENDING) {\n    if (chunk._value === null) {\n      chunk._value = [];\n    }\n    chunk._value.push(resolve);\n  } else {\n    resolve();\n  }\n};\n\nexport type ResponseBase = {\n  _bundlerConfig: BundlerConfig,\n  _chunks: Map<number, SomeChunk<any>>,\n  readRoot<T>(): T,\n  ...\n};\n\nexport type {Response};\n\nfunction readChunk<T>(chunk: SomeChunk<T>): T {\n  switch (chunk._status) {\n    case INITIALIZED:\n      return chunk._value;\n    case RESOLVED_MODEL:\n      return initializeModelChunk(chunk);\n    case RESOLVED_MODULE:\n      return initializeModuleChunk(chunk);\n    case PENDING:\n      // eslint-disable-next-line no-throw-literal\n      throw (chunk: Wakeable);\n    default:\n      throw chunk._value;\n  }\n}\n\nfunction readRoot<T>(): T {\n  const response: Response = this;\n  const chunk = getChunk(response, 0);\n  return readChunk(chunk);\n}\n\nfunction createPendingChunk(response: Response): PendingChunk {\n  return new Chunk(PENDING, null, response);\n}\n\nfunction createErrorChunk(response: Response, error: Error): ErroredChunk {\n  return new Chunk(ERRORED, error, response);\n}\n\nfunction createInitializedChunk<T>(\n  response: Response,\n  value: T,\n): InitializedChunk<T> {\n  return new Chunk(INITIALIZED, value, response);\n}\n\nfunction wakeChunk(listeners: null | Array<() => mixed>) {\n  if (listeners !== null) {\n    for (let i = 0; i < listeners.length; i++) {\n      const listener = listeners[i];\n      listener();\n    }\n  }\n}\n\nfunction triggerErrorOnChunk<T>(chunk: SomeChunk<T>, error: Error): void {\n  if (chunk._status !== PENDING) {\n    // We already resolved. We didn't expect to see this.\n    return;\n  }\n  const listeners = chunk._value;\n  const erroredChunk: ErroredChunk = (chunk: any);\n  erroredChunk._status = ERRORED;\n  erroredChunk._value = error;\n  wakeChunk(listeners);\n}\n\nfunction createResolvedModelChunk(\n  response: Response,\n  value: UninitializedModel,\n): ResolvedModelChunk {\n  return new Chunk(RESOLVED_MODEL, value, response);\n}\n\nfunction createResolvedModuleChunk<T>(\n  response: Response,\n  value: ModuleReference<T>,\n): ResolvedModuleChunk<T> {\n  return new Chunk(RESOLVED_MODULE, value, response);\n}\n\nfunction resolveModelChunk<T>(\n  chunk: SomeChunk<T>,\n  value: UninitializedModel,\n): void {\n  if (chunk._status !== PENDING) {\n    // We already resolved. We didn't expect to see this.\n    return;\n  }\n  const listeners = chunk._value;\n  const resolvedChunk: ResolvedModelChunk = (chunk: any);\n  resolvedChunk._status = RESOLVED_MODEL;\n  resolvedChunk._value = value;\n  wakeChunk(listeners);\n}\n\nfunction resolveModuleChunk<T>(\n  chunk: SomeChunk<T>,\n  value: ModuleReference<T>,\n): void {\n  if (chunk._status !== PENDING) {\n    // We already resolved. We didn't expect to see this.\n    return;\n  }\n  const listeners = chunk._value;\n  const resolvedChunk: ResolvedModuleChunk<T> = (chunk: any);\n  resolvedChunk._status = RESOLVED_MODULE;\n  resolvedChunk._value = value;\n  wakeChunk(listeners);\n}\n\nfunction initializeModelChunk<T>(chunk: ResolvedModelChunk): T {\n  const value: T = parseModel(chunk._response, chunk._value);\n  const initializedChunk: InitializedChunk<T> = (chunk: any);\n  initializedChunk._status = INITIALIZED;\n  initializedChunk._value = value;\n  return value;\n}\n\nfunction initializeModuleChunk<T>(chunk: ResolvedModuleChunk<T>): T {\n  const value: T = requireModule(chunk._value);\n  const initializedChunk: InitializedChunk<T> = (chunk: any);\n  initializedChunk._status = INITIALIZED;\n  initializedChunk._value = value;\n  return value;\n}\n\n// Report that any missing chunks in the model is now going to throw this\n// error upon read. Also notify any pending promises.\nexport function reportGlobalError(response: Response, error: Error): void {\n  response._chunks.forEach(chunk => {\n    // If this chunk was already resolved or errored, it won't\n    // trigger an error but if it wasn't then we need to\n    // because we won't be getting any new data to resolve it.\n    triggerErrorOnChunk(chunk, error);\n  });\n}\n\nfunction createElement(type, key, props): React$Element<any> {\n  const element: any = {\n    // This tag allows us to uniquely identify this as a React Element\n    $$typeof: REACT_ELEMENT_TYPE,\n\n    // Built-in properties that belong on the element\n    type: type,\n    key: key,\n    ref: null,\n    props: props,\n\n    // Record the component responsible for creating this element.\n    _owner: null,\n  };\n  if (__DEV__) {\n    // We don't really need to add any of these but keeping them for good measure.\n    // Unfortunately, _store is enumerable in jest matchers so for equality to\n    // work, I need to keep it or make _store non-enumerable in the other file.\n    element._store = {};\n    Object.defineProperty(element._store, 'validated', {\n      configurable: false,\n      enumerable: false,\n      writable: true,\n      value: true, // This element has already been validated on the server.\n    });\n    Object.defineProperty(element, '_self', {\n      configurable: false,\n      enumerable: false,\n      writable: false,\n      value: null,\n    });\n    Object.defineProperty(element, '_source', {\n      configurable: false,\n      enumerable: false,\n      writable: false,\n      value: null,\n    });\n  }\n  return element;\n}\n\nfunction createLazyChunkWrapper<T>(\n  chunk: SomeChunk<T>,\n): LazyComponent<T, SomeChunk<T>> {\n  const lazyType: LazyComponent<T, SomeChunk<T>> = {\n    $$typeof: REACT_LAZY_TYPE,\n    _payload: chunk,\n    _init: readChunk,\n  };\n  return lazyType;\n}\n\nfunction getChunk(response: Response, id: number): SomeChunk<any> {\n  const chunks = response._chunks;\n  let chunk = chunks.get(id);\n  if (!chunk) {\n    chunk = createPendingChunk(response);\n    chunks.set(id, chunk);\n  }\n  return chunk;\n}\n\nexport function parseModelString(\n  response: Response,\n  parentObject: Object,\n  value: string,\n): any {\n  switch (value[0]) {\n    case '$': {\n      if (value === '$') {\n        return REACT_ELEMENT_TYPE;\n      } else if (value[1] === '$' || value[1] === '@') {\n        // This was an escaped string value.\n        return value.substring(1);\n      } else {\n        const id = parseInt(value.substring(1), 16);\n        const chunk = getChunk(response, id);\n        return readChunk(chunk);\n      }\n    }\n    case '@': {\n      const id = parseInt(value.substring(1), 16);\n      const chunk = getChunk(response, id);\n      // We create a React.lazy wrapper around any lazy values.\n      // When passed into React, we'll know how to suspend on this.\n      return createLazyChunkWrapper(chunk);\n    }\n  }\n  return value;\n}\n\nexport function parseModelTuple(\n  response: Response,\n  value: {+[key: string]: JSONValue} | $ReadOnlyArray<JSONValue>,\n): any {\n  const tuple: [mixed, mixed, mixed, mixed] = (value: any);\n\n  if (tuple[0] === REACT_ELEMENT_TYPE) {\n    // TODO: Consider having React just directly accept these arrays as elements.\n    // Or even change the ReactElement type to be an array.\n    return createElement(tuple[1], tuple[2], tuple[3]);\n  }\n  return value;\n}\n\nexport function createResponse(bundlerConfig: BundlerConfig): ResponseBase {\n  const chunks: Map<number, SomeChunk<any>> = new Map();\n  const response = {\n    _bundlerConfig: bundlerConfig,\n    _chunks: chunks,\n    readRoot: readRoot,\n  };\n  return response;\n}\n\nexport function resolveModel(\n  response: Response,\n  id: number,\n  model: UninitializedModel,\n): void {\n  const chunks = response._chunks;\n  const chunk = chunks.get(id);\n  if (!chunk) {\n    chunks.set(id, createResolvedModelChunk(response, model));\n  } else {\n    resolveModelChunk(chunk, model);\n  }\n}\n\nexport function resolveProvider(\n  response: Response,\n  id: number,\n  contextName: string,\n): void {\n  const chunks = response._chunks;\n  chunks.set(\n    id,\n    createInitializedChunk(\n      response,\n      getOrCreateServerContext(contextName).Provider,\n    ),\n  );\n}\n\nexport function resolveModule(\n  response: Response,\n  id: number,\n  model: UninitializedModel,\n): void {\n  const chunks = response._chunks;\n  const chunk = chunks.get(id);\n  const moduleMetaData: ModuleMetaData = parseModel(response, model);\n  const moduleReference = resolveModuleReference(\n    response._bundlerConfig,\n    moduleMetaData,\n  );\n\n  // TODO: Add an option to encode modules that are lazy loaded.\n  // For now we preload all modules as early as possible since it's likely\n  // that we'll need them.\n  preloadModule(moduleReference);\n\n  if (!chunk) {\n    chunks.set(id, createResolvedModuleChunk(response, moduleReference));\n  } else {\n    resolveModuleChunk(chunk, moduleReference);\n  }\n}\n\nexport function resolveSymbol(\n  response: Response,\n  id: number,\n  name: string,\n): void {\n  const chunks = response._chunks;\n  // We assume that we'll always emit the symbol before anything references it\n  // to save a few bytes.\n  chunks.set(id, createInitializedChunk(response, Symbol.for(name)));\n}\n\nexport function resolveError(\n  response: Response,\n  id: number,\n  message: string,\n  stack: string,\n): void {\n  // eslint-disable-next-line react-internal/prod-error-codes\n  const error = new Error(message);\n  error.stack = stack;\n  const chunks = response._chunks;\n  const chunk = chunks.get(id);\n  if (!chunk) {\n    chunks.set(id, createErrorChunk(response, error));\n  } else {\n    triggerErrorOnChunk(chunk, error);\n  }\n}\n\nexport function close(response: Response): void {\n  // In case there are any remaining unresolved chunks, they won't\n  // be resolved now. So we need to issue an error to those.\n  // Ideally we should be able to early bail out if we kept a\n  // ref count of pending chunks.\n  reportGlobalError(response, new Error('Connection closed.'));\n}\n","/**\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\nimport type {Response} from './ReactFlightClientHostConfigStream';\n\nimport type {BundlerConfig} from './ReactFlightClientHostConfig';\n\nimport {\n  resolveModule,\n  resolveModel,\n  resolveProvider,\n  resolveSymbol,\n  resolveError,\n  createResponse as createResponseBase,\n  parseModelString,\n  parseModelTuple,\n} from './ReactFlightClient';\n\nimport {\n  readPartialStringChunk,\n  readFinalStringChunk,\n  supportsBinaryStreams,\n  createStringDecoder,\n} from './ReactFlightClientHostConfig';\n\nexport type {Response};\n\nfunction processFullRow(response: Response, row: string): void {\n  if (row === '') {\n    return;\n  }\n  const tag = row[0];\n  // When tags that are not text are added, check them here before\n  // parsing the row as text.\n  // switch (tag) {\n  // }\n  const colon = row.indexOf(':', 1);\n  const id = parseInt(row.substring(1, colon), 16);\n  const text = row.substring(colon + 1);\n  switch (tag) {\n    case 'J': {\n      resolveModel(response, id, text);\n      return;\n    }\n    case 'M': {\n      resolveModule(response, id, text);\n      return;\n    }\n    case 'P': {\n      resolveProvider(response, id, text);\n      return;\n    }\n    case 'S': {\n      resolveSymbol(response, id, JSON.parse(text));\n      return;\n    }\n    case 'E': {\n      const errorInfo = JSON.parse(text);\n      resolveError(response, id, errorInfo.message, errorInfo.stack);\n      return;\n    }\n    default: {\n      throw new Error(\n        \"Error parsing the data. It's probably an error code or network corruption.\",\n      );\n    }\n  }\n}\n\nexport function processStringChunk(\n  response: Response,\n  chunk: string,\n  offset: number,\n): void {\n  let linebreak = chunk.indexOf('\\n', offset);\n  while (linebreak > -1) {\n    const fullrow = response._partialRow + chunk.substring(offset, linebreak);\n    processFullRow(response, fullrow);\n    response._partialRow = '';\n    offset = linebreak + 1;\n    linebreak = chunk.indexOf('\\n', offset);\n  }\n  response._partialRow += chunk.substring(offset);\n}\n\nexport function processBinaryChunk(\n  response: Response,\n  chunk: Uint8Array,\n): void {\n  if (!supportsBinaryStreams) {\n    throw new Error(\"This environment don't support binary chunks.\");\n  }\n  const stringDecoder = response._stringDecoder;\n  let linebreak = chunk.indexOf(10); // newline\n  while (linebreak > -1) {\n    const fullrow =\n      response._partialRow +\n      readFinalStringChunk(stringDecoder, chunk.subarray(0, linebreak));\n    processFullRow(response, fullrow);\n    response._partialRow = '';\n    chunk = chunk.subarray(linebreak + 1);\n    linebreak = chunk.indexOf(10); // newline\n  }\n  response._partialRow += readPartialStringChunk(stringDecoder, chunk);\n}\n\nfunction createFromJSONCallback(response: Response) {\n  return function(key: string, value: JSONValue) {\n    if (typeof value === 'string') {\n      // We can't use .bind here because we need the \"this\" value.\n      return parseModelString(response, this, value);\n    }\n    if (typeof value === 'object' && value !== null) {\n      return parseModelTuple(response, value);\n    }\n    return value;\n  };\n}\n\nexport function createResponse(bundlerConfig: BundlerConfig): Response {\n  // NOTE: CHECK THE COMPILER OUTPUT EACH TIME YOU CHANGE THIS.\n  // It should be inlined to one object literal but minor changes can break it.\n  const stringDecoder = supportsBinaryStreams ? createStringDecoder() : null;\n  const response: any = createResponseBase(bundlerConfig);\n  response._partialRow = '';\n  if (supportsBinaryStreams) {\n    response._stringDecoder = stringDecoder;\n  }\n  // Don't inline this call because it causes closure to outline the call above.\n  response._fromJSON = createFromJSONCallback(response);\n  return response;\n}\n\nexport {reportGlobalError, close} from './ReactFlightClient';\n","/**\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\nimport type {Response as FlightResponse} from 'react-client/src/ReactFlightClientStream';\n\nimport type {BundlerConfig} from './ReactFlightClientWebpackBundlerConfig';\n\nimport {\n  createResponse,\n  reportGlobalError,\n  processStringChunk,\n  processBinaryChunk,\n  close,\n} from 'react-client/src/ReactFlightClientStream';\n\nexport type Options = {\n  moduleMap?: BundlerConfig,\n};\n\nfunction startReadingFromStream(\n  response: FlightResponse,\n  stream: ReadableStream,\n): void {\n  const reader = stream.getReader();\n  function progress({done, value}) {\n    if (done) {\n      close(response);\n      return;\n    }\n    const buffer: Uint8Array = (value: any);\n    processBinaryChunk(response, buffer);\n    return reader.read().then(progress, error);\n  }\n  function error(e) {\n    reportGlobalError(response, e);\n  }\n  reader.read().then(progress, error);\n}\n\nfunction createFromReadableStream(\n  stream: ReadableStream,\n  options?: Options,\n): FlightResponse {\n  const response: FlightResponse = createResponse(\n    options && options.moduleMap ? options.moduleMap : null,\n  );\n  startReadingFromStream(response, stream);\n  return response;\n}\n\nfunction createFromFetch(\n  promiseForResponse: Promise<Response>,\n  options?: Options,\n): FlightResponse {\n  const response: FlightResponse = createResponse(\n    options && options.moduleMap ? options.moduleMap : null,\n  );\n  promiseForResponse.then(\n    function(r) {\n      startReadingFromStream(response, (r.body: any));\n    },\n    function(e) {\n      reportGlobalError(response, e);\n    },\n  );\n  return response;\n}\n\nfunction createFromXHR(\n  request: XMLHttpRequest,\n  options?: Options,\n): FlightResponse {\n  const response: FlightResponse = createResponse(\n    options && options.moduleMap ? options.moduleMap : null,\n  );\n  let processedLength = 0;\n  function progress(e: ProgressEvent): void {\n    const chunk = request.responseText;\n    processStringChunk(response, chunk, processedLength);\n    processedLength = chunk.length;\n  }\n  function load(e: ProgressEvent): void {\n    progress(e);\n    close(response);\n  }\n  function error(e: ProgressEvent): void {\n    reportGlobalError(response, new TypeError('Network error'));\n  }\n  request.addEventListener('progress', progress);\n  request.addEventListener('load', load);\n  request.addEventListener('error', error);\n  request.addEventListener('abort', error);\n  request.addEventListener('timeout', error);\n  return response;\n}\n\nexport {createFromXHR, createFromFetch, createFromReadableStream};\n"],"names":["createStringDecoder","TextDecoder","decoderOptions","stream","readPartialStringChunk","decoder","buffer","decode","readFinalStringChunk","parseModel","response","json","JSON","parse","_fromJSON","resolveModuleReference","bundlerConfig","moduleData","id","name","chunkCache","Map","preloadModule","chunks","i","length","chunkId","entry","get","undefined","thenable","__webpack_chunk_load__","resolve","set","bind","reject","then","requireModule","moduleExports","__webpack_require__","__esModule","default","REACT_ELEMENT_TYPE","Symbol","for","REACT_LAZY_TYPE","REACT_SERVER_CONTEXT_DEFAULT_VALUE_NOT_LOADED","ReactSharedInternals","React","ContextRegistry","getOrCreateServerContext","globalName","createServerContext","PENDING","RESOLVED_MODEL","RESOLVED_MODULE","INITIALIZED","ERRORED","Chunk","status","value","_status","_value","_response","prototype","chunk","push","readChunk","initializeModelChunk","initializeModuleChunk","readRoot","getChunk","createPendingChunk","createErrorChunk","error","createInitializedChunk","wakeChunk","listeners","listener","triggerErrorOnChunk","erroredChunk","createResolvedModelChunk","createResolvedModuleChunk","resolveModelChunk","resolvedChunk","resolveModuleChunk","initializedChunk","reportGlobalError","_chunks","forEach","createElement","type","key","props","element","$$typeof","ref","_owner","_store","Object","defineProperty","configurable","enumerable","writable","createLazyChunkWrapper","lazyType","_payload","_init","parseModelString","parentObject","substring","parseInt","parseModelTuple","tuple","createResponse","_bundlerConfig","resolveModel","model","resolveProvider","contextName","Provider","resolveModule","moduleMetaData","moduleReference","resolveSymbol","resolveError","message","stack","Error","close","processFullRow","row","tag","colon","indexOf","text","errorInfo","processStringChunk","offset","linebreak","fullrow","_partialRow","processBinaryChunk","stringDecoder","_stringDecoder","subarray","createFromJSONCallback","supportsBinaryStreams","createResponseBase","startReadingFromStream","reader","getReader","progress","done","read","e","createFromReadableStream","options","moduleMap","createFromFetch","promiseForResponse","r","body","createFromXHR","request","processedLength","responseText","load","TypeError","addEventListener"],"mappings":"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"}