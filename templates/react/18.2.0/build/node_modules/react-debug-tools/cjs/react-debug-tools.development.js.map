{"version":3,"file":"react-debug-tools.development.js","sources":["../../../../packages/shared/assign.js","../../../../packages/shared/ReactSharedInternals.js","../../../../packages/react-reconciler/src/ReactWorkTags.js","../../../../packages/react-debug-tools/src/ReactDebugHooks.js"],"sourcesContent":["/**\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\nconst assign = Object.assign;\n\nexport default assign;\n","/**\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\nimport * as React from 'react';\n\nconst ReactSharedInternals =\n  React.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;\n\nexport default ReactSharedInternals;\n","/**\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\nexport type WorkTag =\n  | 0\n  | 1\n  | 2\n  | 3\n  | 4\n  | 5\n  | 6\n  | 7\n  | 8\n  | 9\n  | 10\n  | 11\n  | 12\n  | 13\n  | 14\n  | 15\n  | 16\n  | 17\n  | 18\n  | 19\n  | 20\n  | 21\n  | 22\n  | 23\n  | 24\n  | 25;\n\nexport const FunctionComponent = 0;\nexport const ClassComponent = 1;\nexport const IndeterminateComponent = 2; // Before we know whether it is function or class\nexport const HostRoot = 3; // Root of a host tree. Could be nested inside another node.\nexport const HostPortal = 4; // A subtree. Could be an entry point to a different renderer.\nexport const HostComponent = 5;\nexport const HostText = 6;\nexport const Fragment = 7;\nexport const Mode = 8;\nexport const ContextConsumer = 9;\nexport const ContextProvider = 10;\nexport const ForwardRef = 11;\nexport const Profiler = 12;\nexport const SuspenseComponent = 13;\nexport const MemoComponent = 14;\nexport const SimpleMemoComponent = 15;\nexport const LazyComponent = 16;\nexport const IncompleteClassComponent = 17;\nexport const DehydratedFragment = 18;\nexport const SuspenseListComponent = 19;\nexport const ScopeComponent = 21;\nexport const OffscreenComponent = 22;\nexport const LegacyHiddenComponent = 23;\nexport const CacheComponent = 24;\nexport const TracingMarkerComponent = 25;\n","/**\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\nimport type {\n  MutableSource,\n  MutableSourceGetSnapshotFn,\n  MutableSourceSubscribeFn,\n  ReactContext,\n  ReactProviderType,\n  StartTransitionOptions,\n} from 'shared/ReactTypes';\nimport type {\n  Fiber,\n  Dispatcher as DispatcherType,\n} from 'react-reconciler/src/ReactInternalTypes';\n\nimport ErrorStackParser from 'error-stack-parser';\nimport assign from 'shared/assign';\nimport ReactSharedInternals from 'shared/ReactSharedInternals';\nimport {\n  FunctionComponent,\n  SimpleMemoComponent,\n  ContextProvider,\n  ForwardRef,\n} from 'react-reconciler/src/ReactWorkTags';\n\ntype CurrentDispatcherRef = typeof ReactSharedInternals.ReactCurrentDispatcher;\n\n// Used to track hooks called during a render\n\ntype HookLogEntry = {\n  primitive: string,\n  stackError: Error,\n  value: mixed,\n  ...\n};\n\nlet hookLog: Array<HookLogEntry> = [];\n\n// Primitives\n\ntype BasicStateAction<S> = (S => S) | S;\n\ntype Dispatch<A> = A => void;\n\nlet primitiveStackCache: null | Map<string, Array<any>> = null;\n\ntype Hook = {\n  memoizedState: any,\n  next: Hook | null,\n};\n\nfunction getPrimitiveStackCache(): Map<string, Array<any>> {\n  // This initializes a cache of all primitive hooks so that the top\n  // most stack frames added by calling the primitive hook can be removed.\n  if (primitiveStackCache === null) {\n    const cache = new Map();\n    let readHookLog;\n    try {\n      // Use all hooks here to add them to the hook log.\n      Dispatcher.useContext(({_currentValue: null}: any));\n      Dispatcher.useState(null);\n      Dispatcher.useReducer((s, a) => s, null);\n      Dispatcher.useRef(null);\n      if (typeof Dispatcher.useCacheRefresh === 'function') {\n        // This type check is for Flow only.\n        Dispatcher.useCacheRefresh();\n      }\n      Dispatcher.useLayoutEffect(() => {});\n      Dispatcher.useInsertionEffect(() => {});\n      Dispatcher.useEffect(() => {});\n      Dispatcher.useImperativeHandle(undefined, () => null);\n      Dispatcher.useDebugValue(null);\n      Dispatcher.useCallback(() => {});\n      Dispatcher.useMemo(() => null);\n    } finally {\n      readHookLog = hookLog;\n      hookLog = [];\n    }\n    for (let i = 0; i < readHookLog.length; i++) {\n      const hook = readHookLog[i];\n      cache.set(hook.primitive, ErrorStackParser.parse(hook.stackError));\n    }\n    primitiveStackCache = cache;\n  }\n  return primitiveStackCache;\n}\n\nlet currentHook: null | Hook = null;\nfunction nextHook(): null | Hook {\n  const hook = currentHook;\n  if (hook !== null) {\n    currentHook = hook.next;\n  }\n  return hook;\n}\n\nfunction getCacheForType<T>(resourceType: () => T): T {\n  throw new Error('Not implemented.');\n}\n\nfunction readContext<T>(context: ReactContext<T>): T {\n  // For now we don't expose readContext usage in the hooks debugging info.\n  return context._currentValue;\n}\n\nfunction useContext<T>(context: ReactContext<T>): T {\n  hookLog.push({\n    primitive: 'Context',\n    stackError: new Error(),\n    value: context._currentValue,\n  });\n  return context._currentValue;\n}\n\nfunction useState<S>(\n  initialState: (() => S) | S,\n): [S, Dispatch<BasicStateAction<S>>] {\n  const hook = nextHook();\n  const state: S =\n    hook !== null\n      ? hook.memoizedState\n      : typeof initialState === 'function'\n      ? // $FlowFixMe: Flow doesn't like mixed types\n        initialState()\n      : initialState;\n  hookLog.push({primitive: 'State', stackError: new Error(), value: state});\n  return [state, (action: BasicStateAction<S>) => {}];\n}\n\nfunction useReducer<S, I, A>(\n  reducer: (S, A) => S,\n  initialArg: I,\n  init?: I => S,\n): [S, Dispatch<A>] {\n  const hook = nextHook();\n  let state;\n  if (hook !== null) {\n    state = hook.memoizedState;\n  } else {\n    state = init !== undefined ? init(initialArg) : ((initialArg: any): S);\n  }\n  hookLog.push({\n    primitive: 'Reducer',\n    stackError: new Error(),\n    value: state,\n  });\n  return [state, (action: A) => {}];\n}\n\nfunction useRef<T>(initialValue: T): {|current: T|} {\n  const hook = nextHook();\n  const ref = hook !== null ? hook.memoizedState : {current: initialValue};\n  hookLog.push({\n    primitive: 'Ref',\n    stackError: new Error(),\n    value: ref.current,\n  });\n  return ref;\n}\n\nfunction useCacheRefresh(): () => void {\n  const hook = nextHook();\n  hookLog.push({\n    primitive: 'CacheRefresh',\n    stackError: new Error(),\n    value: hook !== null ? hook.memoizedState : function refresh() {},\n  });\n  return () => {};\n}\n\nfunction useLayoutEffect(\n  create: () => (() => void) | void,\n  inputs: Array<mixed> | void | null,\n): void {\n  nextHook();\n  hookLog.push({\n    primitive: 'LayoutEffect',\n    stackError: new Error(),\n    value: create,\n  });\n}\n\nfunction useInsertionEffect(\n  create: () => mixed,\n  inputs: Array<mixed> | void | null,\n): void {\n  nextHook();\n  hookLog.push({\n    primitive: 'InsertionEffect',\n    stackError: new Error(),\n    value: create,\n  });\n}\n\nfunction useEffect(\n  create: () => (() => void) | void,\n  inputs: Array<mixed> | void | null,\n): void {\n  nextHook();\n  hookLog.push({primitive: 'Effect', stackError: new Error(), value: create});\n}\n\nfunction useImperativeHandle<T>(\n  ref: {|current: T | null|} | ((inst: T | null) => mixed) | null | void,\n  create: () => T,\n  inputs: Array<mixed> | void | null,\n): void {\n  nextHook();\n  // We don't actually store the instance anywhere if there is no ref callback\n  // and if there is a ref callback it might not store it but if it does we\n  // have no way of knowing where. So let's only enable introspection of the\n  // ref itself if it is using the object form.\n  let instance = undefined;\n  if (ref !== null && typeof ref === 'object') {\n    instance = ref.current;\n  }\n  hookLog.push({\n    primitive: 'ImperativeHandle',\n    stackError: new Error(),\n    value: instance,\n  });\n}\n\nfunction useDebugValue(value: any, formatterFn: ?(value: any) => any) {\n  hookLog.push({\n    primitive: 'DebugValue',\n    stackError: new Error(),\n    value: typeof formatterFn === 'function' ? formatterFn(value) : value,\n  });\n}\n\nfunction useCallback<T>(callback: T, inputs: Array<mixed> | void | null): T {\n  const hook = nextHook();\n  hookLog.push({\n    primitive: 'Callback',\n    stackError: new Error(),\n    value: hook !== null ? hook.memoizedState[0] : callback,\n  });\n  return callback;\n}\n\nfunction useMemo<T>(\n  nextCreate: () => T,\n  inputs: Array<mixed> | void | null,\n): T {\n  const hook = nextHook();\n  const value = hook !== null ? hook.memoizedState[0] : nextCreate();\n  hookLog.push({primitive: 'Memo', stackError: new Error(), value});\n  return value;\n}\n\nfunction useMutableSource<Source, Snapshot>(\n  source: MutableSource<Source>,\n  getSnapshot: MutableSourceGetSnapshotFn<Source, Snapshot>,\n  subscribe: MutableSourceSubscribeFn<Source, Snapshot>,\n): Snapshot {\n  // useMutableSource() composes multiple hooks internally.\n  // Advance the current hook index the same number of times\n  // so that subsequent hooks have the right memoized state.\n  nextHook(); // MutableSource\n  nextHook(); // State\n  nextHook(); // Effect\n  nextHook(); // Effect\n  const value = getSnapshot(source._source);\n  hookLog.push({primitive: 'MutableSource', stackError: new Error(), value});\n  return value;\n}\n\nfunction useSyncExternalStore<T>(\n  subscribe: (() => void) => () => void,\n  getSnapshot: () => T,\n  getServerSnapshot?: () => T,\n): T {\n  // useSyncExternalStore() composes multiple hooks internally.\n  // Advance the current hook index the same number of times\n  // so that subsequent hooks have the right memoized state.\n  nextHook(); // SyncExternalStore\n  nextHook(); // Effect\n  const value = getSnapshot();\n  hookLog.push({\n    primitive: 'SyncExternalStore',\n    stackError: new Error(),\n    value,\n  });\n  return value;\n}\n\nfunction useTransition(): [\n  boolean,\n  (callback: () => void, options?: StartTransitionOptions) => void,\n] {\n  // useTransition() composes multiple hooks internally.\n  // Advance the current hook index the same number of times\n  // so that subsequent hooks have the right memoized state.\n  nextHook(); // State\n  nextHook(); // Callback\n  hookLog.push({\n    primitive: 'Transition',\n    stackError: new Error(),\n    value: undefined,\n  });\n  return [false, callback => {}];\n}\n\nfunction useDeferredValue<T>(value: T): T {\n  // useDeferredValue() composes multiple hooks internally.\n  // Advance the current hook index the same number of times\n  // so that subsequent hooks have the right memoized state.\n  nextHook(); // State\n  nextHook(); // Effect\n  hookLog.push({\n    primitive: 'DeferredValue',\n    stackError: new Error(),\n    value,\n  });\n  return value;\n}\n\nfunction useId(): string {\n  const hook = nextHook();\n  const id = hook !== null ? hook.memoizedState : '';\n  hookLog.push({\n    primitive: 'Id',\n    stackError: new Error(),\n    value: id,\n  });\n  return id;\n}\n\nconst Dispatcher: DispatcherType = {\n  getCacheForType,\n  readContext,\n  useCacheRefresh,\n  useCallback,\n  useContext,\n  useEffect,\n  useImperativeHandle,\n  useDebugValue,\n  useLayoutEffect,\n  useInsertionEffect,\n  useMemo,\n  useReducer,\n  useRef,\n  useState,\n  useTransition,\n  useMutableSource,\n  useSyncExternalStore,\n  useDeferredValue,\n  useId,\n};\n\n// create a proxy to throw a custom error\n// in case future versions of React adds more hooks\nconst DispatcherProxyHandler = {\n  get(target, prop) {\n    if (target.hasOwnProperty(prop)) {\n      return target[prop];\n    }\n    const error = new Error('Missing method in Dispatcher: ' + prop);\n    // Note: This error name needs to stay in sync with react-devtools-shared\n    // TODO: refactor this if we ever combine the devtools and debug tools packages\n    error.name = 'ReactDebugToolsUnsupportedHookError';\n    throw error;\n  },\n};\n\nconst DispatcherProxy = new Proxy(Dispatcher, DispatcherProxyHandler);\n\n// Inspect\n\nexport type HookSource = {\n  lineNumber: number | null,\n  columnNumber: number | null,\n  fileName: string | null,\n  functionName: string | null,\n};\n\nexport type HooksNode = {\n  id: number | null,\n  isStateEditable: boolean,\n  name: string,\n  value: mixed,\n  subHooks: Array<HooksNode>,\n  hookSource?: HookSource,\n  ...\n};\nexport type HooksTree = Array<HooksNode>;\n\n// Don't assume\n//\n// We can't assume that stack frames are nth steps away from anything.\n// E.g. we can't assume that the root call shares all frames with the stack\n// of a hook call. A simple way to demonstrate this is wrapping `new Error()`\n// in a wrapper constructor like a polyfill. That'll add an extra frame.\n// Similar things can happen with the call to the dispatcher. The top frame\n// may not be the primitive. Likewise the primitive can have fewer stack frames\n// such as when a call to useState got inlined to use dispatcher.useState.\n//\n// We also can't assume that the last frame of the root call is the same\n// frame as the last frame of the hook call because long stack traces can be\n// truncated to a stack trace limit.\n\nlet mostLikelyAncestorIndex = 0;\n\nfunction findSharedIndex(hookStack, rootStack, rootIndex) {\n  const source = rootStack[rootIndex].source;\n  hookSearch: for (let i = 0; i < hookStack.length; i++) {\n    if (hookStack[i].source === source) {\n      // This looks like a match. Validate that the rest of both stack match up.\n      for (\n        let a = rootIndex + 1, b = i + 1;\n        a < rootStack.length && b < hookStack.length;\n        a++, b++\n      ) {\n        if (hookStack[b].source !== rootStack[a].source) {\n          // If not, give up and try a different match.\n          continue hookSearch;\n        }\n      }\n      return i;\n    }\n  }\n  return -1;\n}\n\nfunction findCommonAncestorIndex(rootStack, hookStack) {\n  let rootIndex = findSharedIndex(\n    hookStack,\n    rootStack,\n    mostLikelyAncestorIndex,\n  );\n  if (rootIndex !== -1) {\n    return rootIndex;\n  }\n  // If the most likely one wasn't a hit, try any other frame to see if it is shared.\n  // If that takes more than 5 frames, something probably went wrong.\n  for (let i = 0; i < rootStack.length && i < 5; i++) {\n    rootIndex = findSharedIndex(hookStack, rootStack, i);\n    if (rootIndex !== -1) {\n      mostLikelyAncestorIndex = i;\n      return rootIndex;\n    }\n  }\n  return -1;\n}\n\nfunction isReactWrapper(functionName, primitiveName) {\n  if (!functionName) {\n    return false;\n  }\n  const expectedPrimitiveName = 'use' + primitiveName;\n  if (functionName.length < expectedPrimitiveName.length) {\n    return false;\n  }\n  return (\n    functionName.lastIndexOf(expectedPrimitiveName) ===\n    functionName.length - expectedPrimitiveName.length\n  );\n}\n\nfunction findPrimitiveIndex(hookStack, hook) {\n  const stackCache = getPrimitiveStackCache();\n  const primitiveStack = stackCache.get(hook.primitive);\n  if (primitiveStack === undefined) {\n    return -1;\n  }\n  for (let i = 0; i < primitiveStack.length && i < hookStack.length; i++) {\n    if (primitiveStack[i].source !== hookStack[i].source) {\n      // If the next two frames are functions called `useX` then we assume that they're part of the\n      // wrappers that the React packager or other packages adds around the dispatcher.\n      if (\n        i < hookStack.length - 1 &&\n        isReactWrapper(hookStack[i].functionName, hook.primitive)\n      ) {\n        i++;\n      }\n      if (\n        i < hookStack.length - 1 &&\n        isReactWrapper(hookStack[i].functionName, hook.primitive)\n      ) {\n        i++;\n      }\n      return i;\n    }\n  }\n  return -1;\n}\n\nfunction parseTrimmedStack(rootStack, hook) {\n  // Get the stack trace between the primitive hook function and\n  // the root function call. I.e. the stack frames of custom hooks.\n  const hookStack = ErrorStackParser.parse(hook.stackError);\n  const rootIndex = findCommonAncestorIndex(rootStack, hookStack);\n  const primitiveIndex = findPrimitiveIndex(hookStack, hook);\n  if (\n    rootIndex === -1 ||\n    primitiveIndex === -1 ||\n    rootIndex - primitiveIndex < 2\n  ) {\n    // Something went wrong. Give up.\n    return null;\n  }\n  return hookStack.slice(primitiveIndex, rootIndex - 1);\n}\n\nfunction parseCustomHookName(functionName: void | string): string {\n  if (!functionName) {\n    return '';\n  }\n  let startIndex = functionName.lastIndexOf('.');\n  if (startIndex === -1) {\n    startIndex = 0;\n  }\n  if (functionName.substr(startIndex, 3) === 'use') {\n    startIndex += 3;\n  }\n  return functionName.substr(startIndex);\n}\n\nfunction buildTree(\n  rootStack,\n  readHookLog,\n  includeHooksSource: boolean,\n): HooksTree {\n  const rootChildren = [];\n  let prevStack = null;\n  let levelChildren = rootChildren;\n  let nativeHookID = 0;\n  const stackOfChildren = [];\n  for (let i = 0; i < readHookLog.length; i++) {\n    const hook = readHookLog[i];\n    const stack = parseTrimmedStack(rootStack, hook);\n    if (stack !== null) {\n      // Note: The indices 0 <= n < length-1 will contain the names.\n      // The indices 1 <= n < length will contain the source locations.\n      // That's why we get the name from n - 1 and don't check the source\n      // of index 0.\n      let commonSteps = 0;\n      if (prevStack !== null) {\n        // Compare the current level's stack to the new stack.\n        while (commonSteps < stack.length && commonSteps < prevStack.length) {\n          const stackSource = stack[stack.length - commonSteps - 1].source;\n          const prevSource =\n            prevStack[prevStack.length - commonSteps - 1].source;\n          if (stackSource !== prevSource) {\n            break;\n          }\n          commonSteps++;\n        }\n        // Pop back the stack as many steps as were not common.\n        for (let j = prevStack.length - 1; j > commonSteps; j--) {\n          levelChildren = stackOfChildren.pop();\n        }\n      }\n      // The remaining part of the new stack are custom hooks. Push them\n      // to the tree.\n      for (let j = stack.length - commonSteps - 1; j >= 1; j--) {\n        const children = [];\n        const stackFrame = stack[j];\n        const levelChild: HooksNode = {\n          id: null,\n          isStateEditable: false,\n          name: parseCustomHookName(stack[j - 1].functionName),\n          value: undefined,\n          subHooks: children,\n        };\n\n        if (includeHooksSource) {\n          levelChild.hookSource = {\n            lineNumber: stackFrame.lineNumber,\n            columnNumber: stackFrame.columnNumber,\n            functionName: stackFrame.functionName,\n            fileName: stackFrame.fileName,\n          };\n        }\n\n        levelChildren.push(levelChild);\n        stackOfChildren.push(levelChildren);\n        levelChildren = children;\n      }\n      prevStack = stack;\n    }\n    const {primitive} = hook;\n\n    // For now, the \"id\" of stateful hooks is just the stateful hook index.\n    // Custom hooks have no ids, nor do non-stateful native hooks (e.g. Context, DebugValue).\n    const id =\n      primitive === 'Context' || primitive === 'DebugValue'\n        ? null\n        : nativeHookID++;\n\n    // For the time being, only State and Reducer hooks support runtime overrides.\n    const isStateEditable = primitive === 'Reducer' || primitive === 'State';\n    const levelChild: HooksNode = {\n      id,\n      isStateEditable,\n      name: primitive,\n      value: hook.value,\n      subHooks: [],\n    };\n\n    if (includeHooksSource) {\n      const hookSource: HookSource = {\n        lineNumber: null,\n        functionName: null,\n        fileName: null,\n        columnNumber: null,\n      };\n      if (stack && stack.length >= 1) {\n        const stackFrame = stack[0];\n        hookSource.lineNumber = stackFrame.lineNumber;\n        hookSource.functionName = stackFrame.functionName;\n        hookSource.fileName = stackFrame.fileName;\n        hookSource.columnNumber = stackFrame.columnNumber;\n      }\n\n      levelChild.hookSource = hookSource;\n    }\n\n    levelChildren.push(levelChild);\n  }\n\n  // Associate custom hook values (useDebugValue() hook entries) with the correct hooks.\n  processDebugValues(rootChildren, null);\n\n  return rootChildren;\n}\n\n// Custom hooks support user-configurable labels (via the special useDebugValue() hook).\n// That hook adds user-provided values to the hooks tree,\n// but these values aren't intended to appear alongside of the other hooks.\n// Instead they should be attributed to their parent custom hook.\n// This method walks the tree and assigns debug values to their custom hook owners.\nfunction processDebugValues(\n  hooksTree: HooksTree,\n  parentHooksNode: HooksNode | null,\n): void {\n  const debugValueHooksNodes: Array<HooksNode> = [];\n\n  for (let i = 0; i < hooksTree.length; i++) {\n    const hooksNode = hooksTree[i];\n    if (hooksNode.name === 'DebugValue' && hooksNode.subHooks.length === 0) {\n      hooksTree.splice(i, 1);\n      i--;\n      debugValueHooksNodes.push(hooksNode);\n    } else {\n      processDebugValues(hooksNode.subHooks, hooksNode);\n    }\n  }\n\n  // Bubble debug value labels to their custom hook owner.\n  // If there is no parent hook, just ignore them for now.\n  // (We may warn about this in the future.)\n  if (parentHooksNode !== null) {\n    if (debugValueHooksNodes.length === 1) {\n      parentHooksNode.value = debugValueHooksNodes[0].value;\n    } else if (debugValueHooksNodes.length > 1) {\n      parentHooksNode.value = debugValueHooksNodes.map(({value}) => value);\n    }\n  }\n}\n\nfunction handleRenderFunctionError(error: any): void {\n  // original error might be any type.\n  if (\n    error instanceof Error &&\n    error.name === 'ReactDebugToolsUnsupportedHookError'\n  ) {\n    throw error;\n  }\n  // If the error is not caused by an unsupported feature, it means\n  // that the error is caused by user's code in renderFunction.\n  // In this case, we should wrap the original error inside a custom error\n  // so that devtools can give a clear message about it.\n  // $FlowFixMe: Flow doesn't know about 2nd argument of Error constructor\n  const wrapperError = new Error('Error rendering inspected component', {\n    cause: error,\n  });\n  // Note: This error name needs to stay in sync with react-devtools-shared\n  // TODO: refactor this if we ever combine the devtools and debug tools packages\n  wrapperError.name = 'ReactDebugToolsRenderError';\n  // this stage-4 proposal is not supported by all environments yet.\n  wrapperError.cause = error;\n  throw wrapperError;\n}\n\nexport function inspectHooks<Props>(\n  renderFunction: Props => React$Node,\n  props: Props,\n  currentDispatcher: ?CurrentDispatcherRef,\n  includeHooksSource?: boolean = false,\n): HooksTree {\n  // DevTools will pass the current renderer's injected dispatcher.\n  // Other apps might compile debug hooks as part of their app though.\n  if (currentDispatcher == null) {\n    currentDispatcher = ReactSharedInternals.ReactCurrentDispatcher;\n  }\n\n  const previousDispatcher = currentDispatcher.current;\n  let readHookLog;\n  currentDispatcher.current = DispatcherProxy;\n  let ancestorStackError;\n  try {\n    ancestorStackError = new Error();\n    renderFunction(props);\n  } catch (error) {\n    handleRenderFunctionError(error);\n  } finally {\n    readHookLog = hookLog;\n    hookLog = [];\n    currentDispatcher.current = previousDispatcher;\n  }\n  const rootStack = ErrorStackParser.parse(ancestorStackError);\n  return buildTree(rootStack, readHookLog, includeHooksSource);\n}\n\nfunction setupContexts(contextMap: Map<ReactContext<any>, any>, fiber: Fiber) {\n  let current = fiber;\n  while (current) {\n    if (current.tag === ContextProvider) {\n      const providerType: ReactProviderType<any> = current.type;\n      const context: ReactContext<any> = providerType._context;\n      if (!contextMap.has(context)) {\n        // Store the current value that we're going to restore later.\n        contextMap.set(context, context._currentValue);\n        // Set the inner most provider value on the context.\n        context._currentValue = current.memoizedProps.value;\n      }\n    }\n    current = current.return;\n  }\n}\n\nfunction restoreContexts(contextMap: Map<ReactContext<any>, any>) {\n  contextMap.forEach((value, context) => (context._currentValue = value));\n}\n\nfunction inspectHooksOfForwardRef<Props, Ref>(\n  renderFunction: (Props, Ref) => React$Node,\n  props: Props,\n  ref: Ref,\n  currentDispatcher: CurrentDispatcherRef,\n  includeHooksSource: boolean,\n): HooksTree {\n  const previousDispatcher = currentDispatcher.current;\n  let readHookLog;\n  currentDispatcher.current = DispatcherProxy;\n  let ancestorStackError;\n  try {\n    ancestorStackError = new Error();\n    renderFunction(props, ref);\n  } catch (error) {\n    handleRenderFunctionError(error);\n  } finally {\n    readHookLog = hookLog;\n    hookLog = [];\n    currentDispatcher.current = previousDispatcher;\n  }\n  const rootStack = ErrorStackParser.parse(ancestorStackError);\n  return buildTree(rootStack, readHookLog, includeHooksSource);\n}\n\nfunction resolveDefaultProps(Component, baseProps) {\n  if (Component && Component.defaultProps) {\n    // Resolve default props. Taken from ReactElement\n    const props = assign({}, baseProps);\n    const defaultProps = Component.defaultProps;\n    for (const propName in defaultProps) {\n      if (props[propName] === undefined) {\n        props[propName] = defaultProps[propName];\n      }\n    }\n    return props;\n  }\n  return baseProps;\n}\n\nexport function inspectHooksOfFiber(\n  fiber: Fiber,\n  currentDispatcher: ?CurrentDispatcherRef,\n  includeHooksSource?: boolean = false,\n) {\n  // DevTools will pass the current renderer's injected dispatcher.\n  // Other apps might compile debug hooks as part of their app though.\n  if (currentDispatcher == null) {\n    currentDispatcher = ReactSharedInternals.ReactCurrentDispatcher;\n  }\n\n  if (\n    fiber.tag !== FunctionComponent &&\n    fiber.tag !== SimpleMemoComponent &&\n    fiber.tag !== ForwardRef\n  ) {\n    throw new Error(\n      'Unknown Fiber. Needs to be a function component to inspect hooks.',\n    );\n  }\n  // Warm up the cache so that it doesn't consume the currentHook.\n  getPrimitiveStackCache();\n  const type = fiber.type;\n  let props = fiber.memoizedProps;\n  if (type !== fiber.elementType) {\n    props = resolveDefaultProps(type, props);\n  }\n  // Set up the current hook so that we can step through and read the\n  // current state from them.\n  currentHook = (fiber.memoizedState: Hook);\n  const contextMap = new Map();\n  try {\n    setupContexts(contextMap, fiber);\n    if (fiber.tag === ForwardRef) {\n      return inspectHooksOfForwardRef(\n        type.render,\n        props,\n        fiber.ref,\n        currentDispatcher,\n        includeHooksSource,\n      );\n    }\n    return inspectHooks(type, props, currentDispatcher, includeHooksSource);\n  } finally {\n    currentHook = null;\n    restoreContexts(contextMap);\n  }\n}\n"],"names":["assign","Object","ReactSharedInternals","React","FunctionComponent","ContextProvider","ForwardRef","SimpleMemoComponent","hookLog","primitiveStackCache","getPrimitiveStackCache","cache","Map","readHookLog","Dispatcher","useContext","_currentValue","useState","useReducer","s","a","useRef","useCacheRefresh","useLayoutEffect","useInsertionEffect","useEffect","useImperativeHandle","undefined","useDebugValue","useCallback","useMemo","i","length","hook","set","primitive","ErrorStackParser","parse","stackError","currentHook","nextHook","next","getCacheForType","resourceType","Error","readContext","context","push","value","initialState","state","memoizedState","action","reducer","initialArg","init","initialValue","ref","current","refresh","create","inputs","instance","formatterFn","callback","nextCreate","useMutableSource","source","getSnapshot","subscribe","_source","useSyncExternalStore","getServerSnapshot","useTransition","useDeferredValue","useId","id","DispatcherProxyHandler","get","target","prop","hasOwnProperty","error","name","DispatcherProxy","Proxy","mostLikelyAncestorIndex","findSharedIndex","hookStack","rootStack","rootIndex","hookSearch","b","findCommonAncestorIndex","isReactWrapper","functionName","primitiveName","expectedPrimitiveName","lastIndexOf","findPrimitiveIndex","stackCache","primitiveStack","parseTrimmedStack","primitiveIndex","slice","parseCustomHookName","startIndex","substr","buildTree","includeHooksSource","rootChildren","prevStack","levelChildren","nativeHookID","stackOfChildren","stack","commonSteps","stackSource","prevSource","j","pop","children","stackFrame","levelChild","isStateEditable","subHooks","hookSource","lineNumber","columnNumber","fileName","processDebugValues","hooksTree","parentHooksNode","debugValueHooksNodes","hooksNode","splice","map","handleRenderFunctionError","wrapperError","cause","inspectHooks","renderFunction","props","currentDispatcher","ReactCurrentDispatcher","previousDispatcher","ancestorStackError","setupContexts","contextMap","fiber","tag","providerType","type","_context","has","memoizedProps","return","restoreContexts","forEach","inspectHooksOfForwardRef","resolveDefaultProps","Component","baseProps","defaultProps","propName","inspectHooksOfFiber","elementType","render"],"mappings":";;;;;AASA,IAAMA,MAAM,GAAGC,MAAM,CAACD,MAAtB;;ACEA,IAAME,oBAAoB,GACxBC,wDADF;;AC0BO,IAAMC,iBAAiB,GAAG,CAA1B;AACP,AASO,IAAMC,eAAe,GAAG,EAAxB;AACP,AAAO,IAAMC,UAAU,GAAG,EAAnB;AACP,AAGO,IAAMC,mBAAmB,GAAG,EAA5B;;ACTP,IAAIC,OAA4B,GAAG,EAAnC;;AAQA,IAAIC,mBAAmD,GAAG,IAA1D;;AAOA,SAASC,sBAAT,GAA2D;AACzD;AACA;AACA,MAAID,mBAAmB,KAAK,IAA5B,EAAkC;AAChC,QAAME,KAAK,GAAG,IAAIC,GAAJ,EAAd;AACA,QAAIC,WAAJ;;AACA,QAAI;AACF;AACAC,MAAAA,UAAU,CAACC,UAAX,CAAuB;AAACC,QAAAA,aAAa,EAAE;AAAhB,OAAvB;AACAF,MAAAA,UAAU,CAACG,QAAX,CAAoB,IAApB;AACAH,MAAAA,UAAU,CAACI,UAAX,CAAsB,UAACC,CAAD,EAAIC,CAAJ;AAAA,eAAUD,CAAV;AAAA,OAAtB,EAAmC,IAAnC;AACAL,MAAAA,UAAU,CAACO,MAAX,CAAkB,IAAlB;;AACA,UAAI,OAAOP,UAAU,CAACQ,eAAlB,KAAsC,UAA1C,EAAsD;AACpD;AACAR,QAAAA,UAAU,CAACQ,eAAX;AACD;;AACDR,MAAAA,UAAU,CAACS,eAAX,CAA2B,YAAM,EAAjC;AACAT,MAAAA,UAAU,CAACU,kBAAX,CAA8B,YAAM,EAApC;AACAV,MAAAA,UAAU,CAACW,SAAX,CAAqB,YAAM,EAA3B;AACAX,MAAAA,UAAU,CAACY,mBAAX,CAA+BC,SAA/B,EAA0C;AAAA,eAAM,IAAN;AAAA,OAA1C;AACAb,MAAAA,UAAU,CAACc,aAAX,CAAyB,IAAzB;AACAd,MAAAA,UAAU,CAACe,WAAX,CAAuB,YAAM,EAA7B;AACAf,MAAAA,UAAU,CAACgB,OAAX,CAAmB;AAAA,eAAM,IAAN;AAAA,OAAnB;AACD,KAjBD,SAiBU;AACRjB,MAAAA,WAAW,GAAGL,OAAd;AACAA,MAAAA,OAAO,GAAG,EAAV;AACD;;AACD,SAAK,IAAIuB,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGlB,WAAW,CAACmB,MAAhC,EAAwCD,CAAC,EAAzC,EAA6C;AAC3C,UAAME,IAAI,GAAGpB,WAAW,CAACkB,CAAD,CAAxB;AACApB,MAAAA,KAAK,CAACuB,GAAN,CAAUD,IAAI,CAACE,SAAf,EAA0BC,gBAAgB,CAACC,KAAjB,CAAuBJ,IAAI,CAACK,UAA5B,CAA1B;AACD;;AACD7B,IAAAA,mBAAmB,GAAGE,KAAtB;AACD;;AACD,SAAOF,mBAAP;AACD;;AAED,IAAI8B,WAAwB,GAAG,IAA/B;;AACA,SAASC,QAAT,GAAiC;AAC/B,MAAMP,IAAI,GAAGM,WAAb;;AACA,MAAIN,IAAI,KAAK,IAAb,EAAmB;AACjBM,IAAAA,WAAW,GAAGN,IAAI,CAACQ,IAAnB;AACD;;AACD,SAAOR,IAAP;AACD;;AAED,SAASS,eAAT,CAA4BC,YAA5B,EAAsD;AACpD,QAAM,IAAIC,KAAJ,CAAU,kBAAV,CAAN;AACD;;AAED,SAASC,WAAT,CAAwBC,OAAxB,EAAqD;AACnD;AACA,SAAOA,OAAO,CAAC9B,aAAf;AACD;;AAED,SAASD,UAAT,CAAuB+B,OAAvB,EAAoD;AAClDtC,EAAAA,OAAO,CAACuC,IAAR,CAAa;AACXZ,IAAAA,SAAS,EAAE,SADA;AAEXG,IAAAA,UAAU,EAAE,IAAIM,KAAJ,EAFD;AAGXI,IAAAA,KAAK,EAAEF,OAAO,CAAC9B;AAHJ,GAAb;AAKA,SAAO8B,OAAO,CAAC9B,aAAf;AACD;;AAED,SAASC,QAAT,CACEgC,YADF,EAEsC;AACpC,MAAMhB,IAAI,GAAGO,QAAQ,EAArB;AACA,MAAMU,KAAQ,GACZjB,IAAI,KAAK,IAAT,GACIA,IAAI,CAACkB,aADT,GAEI,OAAOF,YAAP,KAAwB,UAAxB;AAEAA,EAAAA,YAAY,EAFZ,GAGAA,YANN;AAOAzC,EAAAA,OAAO,CAACuC,IAAR,CAAa;AAACZ,IAAAA,SAAS,EAAE,OAAZ;AAAqBG,IAAAA,UAAU,EAAE,IAAIM,KAAJ,EAAjC;AAA8CI,IAAAA,KAAK,EAAEE;AAArD,GAAb;AACA,SAAO,CAACA,KAAD,EAAQ,UAACE,MAAD,EAAiC,EAAzC,CAAP;AACD;;AAED,SAASlC,UAAT,CACEmC,OADF,EAEEC,UAFF,EAGEC,IAHF,EAIoB;AAClB,MAAMtB,IAAI,GAAGO,QAAQ,EAArB;AACA,MAAIU,KAAJ;;AACA,MAAIjB,IAAI,KAAK,IAAb,EAAmB;AACjBiB,IAAAA,KAAK,GAAGjB,IAAI,CAACkB,aAAb;AACD,GAFD,MAEO;AACLD,IAAAA,KAAK,GAAGK,IAAI,KAAK5B,SAAT,GAAqB4B,IAAI,CAACD,UAAD,CAAzB,GAA0CA,UAAlD;AACD;;AACD9C,EAAAA,OAAO,CAACuC,IAAR,CAAa;AACXZ,IAAAA,SAAS,EAAE,SADA;AAEXG,IAAAA,UAAU,EAAE,IAAIM,KAAJ,EAFD;AAGXI,IAAAA,KAAK,EAAEE;AAHI,GAAb;AAKA,SAAO,CAACA,KAAD,EAAQ,UAACE,MAAD,EAAe,EAAvB,CAAP;AACD;;AAED,SAAS/B,MAAT,CAAmBmC,YAAnB,EAAoD;AAClD,MAAMvB,IAAI,GAAGO,QAAQ,EAArB;AACA,MAAMiB,GAAG,GAAGxB,IAAI,KAAK,IAAT,GAAgBA,IAAI,CAACkB,aAArB,GAAqC;AAACO,IAAAA,OAAO,EAAEF;AAAV,GAAjD;AACAhD,EAAAA,OAAO,CAACuC,IAAR,CAAa;AACXZ,IAAAA,SAAS,EAAE,KADA;AAEXG,IAAAA,UAAU,EAAE,IAAIM,KAAJ,EAFD;AAGXI,IAAAA,KAAK,EAAES,GAAG,CAACC;AAHA,GAAb;AAKA,SAAOD,GAAP;AACD;;AAED,SAASnC,eAAT,GAAuC;AACrC,MAAMW,IAAI,GAAGO,QAAQ,EAArB;AACAhC,EAAAA,OAAO,CAACuC,IAAR,CAAa;AACXZ,IAAAA,SAAS,EAAE,cADA;AAEXG,IAAAA,UAAU,EAAE,IAAIM,KAAJ,EAFD;AAGXI,IAAAA,KAAK,EAAEf,IAAI,KAAK,IAAT,GAAgBA,IAAI,CAACkB,aAArB,GAAqC,SAASQ,OAAT,GAAmB;AAHpD,GAAb;AAKA,SAAO,YAAM,EAAb;AACD;;AAED,SAASpC,eAAT,CACEqC,MADF,EAEEC,MAFF,EAGQ;AACNrB,EAAAA,QAAQ;AACRhC,EAAAA,OAAO,CAACuC,IAAR,CAAa;AACXZ,IAAAA,SAAS,EAAE,cADA;AAEXG,IAAAA,UAAU,EAAE,IAAIM,KAAJ,EAFD;AAGXI,IAAAA,KAAK,EAAEY;AAHI,GAAb;AAKD;;AAED,SAASpC,kBAAT,CACEoC,MADF,EAEEC,MAFF,EAGQ;AACNrB,EAAAA,QAAQ;AACRhC,EAAAA,OAAO,CAACuC,IAAR,CAAa;AACXZ,IAAAA,SAAS,EAAE,iBADA;AAEXG,IAAAA,UAAU,EAAE,IAAIM,KAAJ,EAFD;AAGXI,IAAAA,KAAK,EAAEY;AAHI,GAAb;AAKD;;AAED,SAASnC,SAAT,CACEmC,MADF,EAEEC,MAFF,EAGQ;AACNrB,EAAAA,QAAQ;AACRhC,EAAAA,OAAO,CAACuC,IAAR,CAAa;AAACZ,IAAAA,SAAS,EAAE,QAAZ;AAAsBG,IAAAA,UAAU,EAAE,IAAIM,KAAJ,EAAlC;AAA+CI,IAAAA,KAAK,EAAEY;AAAtD,GAAb;AACD;;AAED,SAASlC,mBAAT,CACE+B,GADF,EAEEG,MAFF,EAGEC,MAHF,EAIQ;AACNrB,EAAAA,QAAQ,GADF;AAGN;AACA;AACA;;AACA,MAAIsB,QAAQ,GAAGnC,SAAf;;AACA,MAAI8B,GAAG,KAAK,IAAR,IAAgB,OAAOA,GAAP,KAAe,QAAnC,EAA6C;AAC3CK,IAAAA,QAAQ,GAAGL,GAAG,CAACC,OAAf;AACD;;AACDlD,EAAAA,OAAO,CAACuC,IAAR,CAAa;AACXZ,IAAAA,SAAS,EAAE,kBADA;AAEXG,IAAAA,UAAU,EAAE,IAAIM,KAAJ,EAFD;AAGXI,IAAAA,KAAK,EAAEc;AAHI,GAAb;AAKD;;AAED,SAASlC,aAAT,CAAuBoB,KAAvB,EAAmCe,WAAnC,EAAsE;AACpEvD,EAAAA,OAAO,CAACuC,IAAR,CAAa;AACXZ,IAAAA,SAAS,EAAE,YADA;AAEXG,IAAAA,UAAU,EAAE,IAAIM,KAAJ,EAFD;AAGXI,IAAAA,KAAK,EAAE,OAAOe,WAAP,KAAuB,UAAvB,GAAoCA,WAAW,CAACf,KAAD,CAA/C,GAAyDA;AAHrD,GAAb;AAKD;;AAED,SAASnB,WAAT,CAAwBmC,QAAxB,EAAqCH,MAArC,EAA4E;AAC1E,MAAM5B,IAAI,GAAGO,QAAQ,EAArB;AACAhC,EAAAA,OAAO,CAACuC,IAAR,CAAa;AACXZ,IAAAA,SAAS,EAAE,UADA;AAEXG,IAAAA,UAAU,EAAE,IAAIM,KAAJ,EAFD;AAGXI,IAAAA,KAAK,EAAEf,IAAI,KAAK,IAAT,GAAgBA,IAAI,CAACkB,aAAL,CAAmB,CAAnB,CAAhB,GAAwCa;AAHpC,GAAb;AAKA,SAAOA,QAAP;AACD;;AAED,SAASlC,OAAT,CACEmC,UADF,EAEEJ,MAFF,EAGK;AACH,MAAM5B,IAAI,GAAGO,QAAQ,EAArB;AACA,MAAMQ,KAAK,GAAGf,IAAI,KAAK,IAAT,GAAgBA,IAAI,CAACkB,aAAL,CAAmB,CAAnB,CAAhB,GAAwCc,UAAU,EAAhE;AACAzD,EAAAA,OAAO,CAACuC,IAAR,CAAa;AAACZ,IAAAA,SAAS,EAAE,MAAZ;AAAoBG,IAAAA,UAAU,EAAE,IAAIM,KAAJ,EAAhC;AAA6CI,IAAAA,KAAK,EAALA;AAA7C,GAAb;AACA,SAAOA,KAAP;AACD;;AAED,SAASkB,gBAAT,CACEC,MADF,EAEEC,WAFF,EAGEC,SAHF,EAIY;AACV;AACA;AACA;AACA7B,EAAAA,QAAQ,GAJE;;AAKVA,EAAAA,QAAQ,GALE;;AAMVA,EAAAA,QAAQ,GANE;;AAOVA,EAAAA,QAAQ,GAPE;;AAQV,MAAMQ,KAAK,GAAGoB,WAAW,CAACD,MAAM,CAACG,OAAR,CAAzB;AACA9D,EAAAA,OAAO,CAACuC,IAAR,CAAa;AAACZ,IAAAA,SAAS,EAAE,eAAZ;AAA6BG,IAAAA,UAAU,EAAE,IAAIM,KAAJ,EAAzC;AAAsDI,IAAAA,KAAK,EAALA;AAAtD,GAAb;AACA,SAAOA,KAAP;AACD;;AAED,SAASuB,oBAAT,CACEF,SADF,EAEED,WAFF,EAGEI,iBAHF,EAIK;AACH;AACA;AACA;AACAhC,EAAAA,QAAQ,GAJL;;AAKHA,EAAAA,QAAQ,GALL;;AAMH,MAAMQ,KAAK,GAAGoB,WAAW,EAAzB;AACA5D,EAAAA,OAAO,CAACuC,IAAR,CAAa;AACXZ,IAAAA,SAAS,EAAE,mBADA;AAEXG,IAAAA,UAAU,EAAE,IAAIM,KAAJ,EAFD;AAGXI,IAAAA,KAAK,EAALA;AAHW,GAAb;AAKA,SAAOA,KAAP;AACD;;AAED,SAASyB,aAAT,GAGE;AACA;AACA;AACA;AACAjC,EAAAA,QAAQ,GAJR;;AAKAA,EAAAA,QAAQ,GALR;;AAMAhC,EAAAA,OAAO,CAACuC,IAAR,CAAa;AACXZ,IAAAA,SAAS,EAAE,YADA;AAEXG,IAAAA,UAAU,EAAE,IAAIM,KAAJ,EAFD;AAGXI,IAAAA,KAAK,EAAErB;AAHI,GAAb;AAKA,SAAO,CAAC,KAAD,EAAQ,UAAAqC,QAAQ,EAAI,EAApB,CAAP;AACD;;AAED,SAASU,gBAAT,CAA6B1B,KAA7B,EAA0C;AACxC;AACA;AACA;AACAR,EAAAA,QAAQ,GAJgC;;AAKxCA,EAAAA,QAAQ,GALgC;;AAMxChC,EAAAA,OAAO,CAACuC,IAAR,CAAa;AACXZ,IAAAA,SAAS,EAAE,eADA;AAEXG,IAAAA,UAAU,EAAE,IAAIM,KAAJ,EAFD;AAGXI,IAAAA,KAAK,EAALA;AAHW,GAAb;AAKA,SAAOA,KAAP;AACD;;AAED,SAAS2B,KAAT,GAAyB;AACvB,MAAM1C,IAAI,GAAGO,QAAQ,EAArB;AACA,MAAMoC,EAAE,GAAG3C,IAAI,KAAK,IAAT,GAAgBA,IAAI,CAACkB,aAArB,GAAqC,EAAhD;AACA3C,EAAAA,OAAO,CAACuC,IAAR,CAAa;AACXZ,IAAAA,SAAS,EAAE,IADA;AAEXG,IAAAA,UAAU,EAAE,IAAIM,KAAJ,EAFD;AAGXI,IAAAA,KAAK,EAAE4B;AAHI,GAAb;AAKA,SAAOA,EAAP;AACD;;AAED,IAAM9D,UAA0B,GAAG;AACjC4B,EAAAA,eAAe,EAAfA,eADiC;AAEjCG,EAAAA,WAAW,EAAXA,WAFiC;AAGjCvB,EAAAA,eAAe,EAAfA,eAHiC;AAIjCO,EAAAA,WAAW,EAAXA,WAJiC;AAKjCd,EAAAA,UAAU,EAAVA,UALiC;AAMjCU,EAAAA,SAAS,EAATA,SANiC;AAOjCC,EAAAA,mBAAmB,EAAnBA,mBAPiC;AAQjCE,EAAAA,aAAa,EAAbA,aARiC;AASjCL,EAAAA,eAAe,EAAfA,eATiC;AAUjCC,EAAAA,kBAAkB,EAAlBA,kBAViC;AAWjCM,EAAAA,OAAO,EAAPA,OAXiC;AAYjCZ,EAAAA,UAAU,EAAVA,UAZiC;AAajCG,EAAAA,MAAM,EAANA,MAbiC;AAcjCJ,EAAAA,QAAQ,EAARA,QAdiC;AAejCwD,EAAAA,aAAa,EAAbA,aAfiC;AAgBjCP,EAAAA,gBAAgB,EAAhBA,gBAhBiC;AAiBjCK,EAAAA,oBAAoB,EAApBA,oBAjBiC;AAkBjCG,EAAAA,gBAAgB,EAAhBA,gBAlBiC;AAmBjCC,EAAAA,KAAK,EAALA;AAnBiC,CAAnC;AAuBA;;AACA,IAAME,sBAAsB,GAAG;AAC7BC,EAAAA,GAD6B,YACzBC,MADyB,EACjBC,IADiB,EACX;AAChB,QAAID,MAAM,CAACE,cAAP,CAAsBD,IAAtB,CAAJ,EAAiC;AAC/B,aAAOD,MAAM,CAACC,IAAD,CAAb;AACD;;AACD,QAAME,KAAK,GAAG,IAAItC,KAAJ,CAAU,mCAAmCoC,IAA7C,CAAd,CAJgB;AAMhB;;AACAE,IAAAA,KAAK,CAACC,IAAN,GAAa,qCAAb;AACA,UAAMD,KAAN;AACD;AAV4B,CAA/B;AAaA,IAAME,eAAe,GAAG,IAAIC,KAAJ,CAAUvE,UAAV,EAAsB+D,sBAAtB,CAAxB;;AAsBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA,IAAIS,uBAAuB,GAAG,CAA9B;;AAEA,SAASC,eAAT,CAAyBC,SAAzB,EAAoCC,SAApC,EAA+CC,SAA/C,EAA0D;AACxD,MAAMvB,MAAM,GAAGsB,SAAS,CAACC,SAAD,CAAT,CAAqBvB,MAApC;;AACAwB,EAAAA,UAAU,EAAE,KAAK,IAAI5D,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGyD,SAAS,CAACxD,MAA9B,EAAsCD,CAAC,EAAvC,EAA2C;AACrD,QAAIyD,SAAS,CAACzD,CAAD,CAAT,CAAaoC,MAAb,KAAwBA,MAA5B,EAAoC;AAClC;AACA,WACE,IAAI/C,CAAC,GAAGsE,SAAS,GAAG,CAApB,EAAuBE,CAAC,GAAG7D,CAAC,GAAG,CADjC,EAEEX,CAAC,GAAGqE,SAAS,CAACzD,MAAd,IAAwB4D,CAAC,GAAGJ,SAAS,CAACxD,MAFxC,EAGEZ,CAAC,IAAIwE,CAAC,EAHR,EAIE;AACA,YAAIJ,SAAS,CAACI,CAAD,CAAT,CAAazB,MAAb,KAAwBsB,SAAS,CAACrE,CAAD,CAAT,CAAa+C,MAAzC,EAAiD;AAC/C;AACA,mBAASwB,UAAT;AACD;AACF;;AACD,aAAO5D,CAAP;AACD;AACF;;AACD,SAAO,CAAC,CAAR;AACD;;AAED,SAAS8D,uBAAT,CAAiCJ,SAAjC,EAA4CD,SAA5C,EAAuD;AACrD,MAAIE,SAAS,GAAGH,eAAe,CAC7BC,SAD6B,EAE7BC,SAF6B,EAG7BH,uBAH6B,CAA/B;;AAKA,MAAII,SAAS,KAAK,CAAC,CAAnB,EAAsB;AACpB,WAAOA,SAAP;AACD,GARoD;AAUrD;;;AACA,OAAK,IAAI3D,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG0D,SAAS,CAACzD,MAAd,IAAwBD,CAAC,GAAG,CAA5C,EAA+CA,CAAC,EAAhD,EAAoD;AAClD2D,IAAAA,SAAS,GAAGH,eAAe,CAACC,SAAD,EAAYC,SAAZ,EAAuB1D,CAAvB,CAA3B;;AACA,QAAI2D,SAAS,KAAK,CAAC,CAAnB,EAAsB;AACpBJ,MAAAA,uBAAuB,GAAGvD,CAA1B;AACA,aAAO2D,SAAP;AACD;AACF;;AACD,SAAO,CAAC,CAAR;AACD;;AAED,SAASI,cAAT,CAAwBC,YAAxB,EAAsCC,aAAtC,EAAqD;AACnD,MAAI,CAACD,YAAL,EAAmB;AACjB,WAAO,KAAP;AACD;;AACD,MAAME,qBAAqB,GAAG,QAAQD,aAAtC;;AACA,MAAID,YAAY,CAAC/D,MAAb,GAAsBiE,qBAAqB,CAACjE,MAAhD,EAAwD;AACtD,WAAO,KAAP;AACD;;AACD,SACE+D,YAAY,CAACG,WAAb,CAAyBD,qBAAzB,MACAF,YAAY,CAAC/D,MAAb,GAAsBiE,qBAAqB,CAACjE,MAF9C;AAID;;AAED,SAASmE,kBAAT,CAA4BX,SAA5B,EAAuCvD,IAAvC,EAA6C;AAC3C,MAAMmE,UAAU,GAAG1F,sBAAsB,EAAzC;AACA,MAAM2F,cAAc,GAAGD,UAAU,CAACtB,GAAX,CAAe7C,IAAI,CAACE,SAApB,CAAvB;;AACA,MAAIkE,cAAc,KAAK1E,SAAvB,EAAkC;AAChC,WAAO,CAAC,CAAR;AACD;;AACD,OAAK,IAAII,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGsE,cAAc,CAACrE,MAAnB,IAA6BD,CAAC,GAAGyD,SAAS,CAACxD,MAA3D,EAAmED,CAAC,EAApE,EAAwE;AACtE,QAAIsE,cAAc,CAACtE,CAAD,CAAd,CAAkBoC,MAAlB,KAA6BqB,SAAS,CAACzD,CAAD,CAAT,CAAaoC,MAA9C,EAAsD;AACpD;AACA;AACA,UACEpC,CAAC,GAAGyD,SAAS,CAACxD,MAAV,GAAmB,CAAvB,IACA8D,cAAc,CAACN,SAAS,CAACzD,CAAD,CAAT,CAAagE,YAAd,EAA4B9D,IAAI,CAACE,SAAjC,CAFhB,EAGE;AACAJ,QAAAA,CAAC;AACF;;AACD,UACEA,CAAC,GAAGyD,SAAS,CAACxD,MAAV,GAAmB,CAAvB,IACA8D,cAAc,CAACN,SAAS,CAACzD,CAAD,CAAT,CAAagE,YAAd,EAA4B9D,IAAI,CAACE,SAAjC,CAFhB,EAGE;AACAJ,QAAAA,CAAC;AACF;;AACD,aAAOA,CAAP;AACD;AACF;;AACD,SAAO,CAAC,CAAR;AACD;;AAED,SAASuE,iBAAT,CAA2Bb,SAA3B,EAAsCxD,IAAtC,EAA4C;AAC1C;AACA;AACA,MAAMuD,SAAS,GAAGpD,gBAAgB,CAACC,KAAjB,CAAuBJ,IAAI,CAACK,UAA5B,CAAlB;AACA,MAAMoD,SAAS,GAAGG,uBAAuB,CAACJ,SAAD,EAAYD,SAAZ,CAAzC;AACA,MAAMe,cAAc,GAAGJ,kBAAkB,CAACX,SAAD,EAAYvD,IAAZ,CAAzC;;AACA,MACEyD,SAAS,KAAK,CAAC,CAAf,IACAa,cAAc,KAAK,CAAC,CADpB,IAEAb,SAAS,GAAGa,cAAZ,GAA6B,CAH/B,EAIE;AACA;AACA,WAAO,IAAP;AACD;;AACD,SAAOf,SAAS,CAACgB,KAAV,CAAgBD,cAAhB,EAAgCb,SAAS,GAAG,CAA5C,CAAP;AACD;;AAED,SAASe,mBAAT,CAA6BV,YAA7B,EAAkE;AAChE,MAAI,CAACA,YAAL,EAAmB;AACjB,WAAO,EAAP;AACD;;AACD,MAAIW,UAAU,GAAGX,YAAY,CAACG,WAAb,CAAyB,GAAzB,CAAjB;;AACA,MAAIQ,UAAU,KAAK,CAAC,CAApB,EAAuB;AACrBA,IAAAA,UAAU,GAAG,CAAb;AACD;;AACD,MAAIX,YAAY,CAACY,MAAb,CAAoBD,UAApB,EAAgC,CAAhC,MAAuC,KAA3C,EAAkD;AAChDA,IAAAA,UAAU,IAAI,CAAd;AACD;;AACD,SAAOX,YAAY,CAACY,MAAb,CAAoBD,UAApB,CAAP;AACD;;AAED,SAASE,SAAT,CACEnB,SADF,EAEE5E,WAFF,EAGEgG,kBAHF,EAIa;AACX,MAAMC,YAAY,GAAG,EAArB;AACA,MAAIC,SAAS,GAAG,IAAhB;AACA,MAAIC,aAAa,GAAGF,YAApB;AACA,MAAIG,YAAY,GAAG,CAAnB;AACA,MAAMC,eAAe,GAAG,EAAxB;;AACA,OAAK,IAAInF,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGlB,WAAW,CAACmB,MAAhC,EAAwCD,CAAC,EAAzC,EAA6C;AAC3C,QAAME,IAAI,GAAGpB,WAAW,CAACkB,CAAD,CAAxB;AACA,QAAMoF,KAAK,GAAGb,iBAAiB,CAACb,SAAD,EAAYxD,IAAZ,CAA/B;;AACA,QAAIkF,KAAK,KAAK,IAAd,EAAoB;AAClB;AACA;AACA;AACA;AACA,UAAIC,WAAW,GAAG,CAAlB;;AACA,UAAIL,SAAS,KAAK,IAAlB,EAAwB;AACtB;AACA,eAAOK,WAAW,GAAGD,KAAK,CAACnF,MAApB,IAA8BoF,WAAW,GAAGL,SAAS,CAAC/E,MAA7D,EAAqE;AACnE,cAAMqF,WAAW,GAAGF,KAAK,CAACA,KAAK,CAACnF,MAAN,GAAeoF,WAAf,GAA6B,CAA9B,CAAL,CAAsCjD,MAA1D;AACA,cAAMmD,UAAU,GACdP,SAAS,CAACA,SAAS,CAAC/E,MAAV,GAAmBoF,WAAnB,GAAiC,CAAlC,CAAT,CAA8CjD,MADhD;;AAEA,cAAIkD,WAAW,KAAKC,UAApB,EAAgC;AAC9B;AACD;;AACDF,UAAAA,WAAW;AACZ,SAVqB;;;AAYtB,aAAK,IAAIG,CAAC,GAAGR,SAAS,CAAC/E,MAAV,GAAmB,CAAhC,EAAmCuF,CAAC,GAAGH,WAAvC,EAAoDG,CAAC,EAArD,EAAyD;AACvDP,UAAAA,aAAa,GAAGE,eAAe,CAACM,GAAhB,EAAhB;AACD;AACF,OArBiB;AAuBlB;;;AACA,WAAK,IAAID,EAAC,GAAGJ,KAAK,CAACnF,MAAN,GAAeoF,WAAf,GAA6B,CAA1C,EAA6CG,EAAC,IAAI,CAAlD,EAAqDA,EAAC,EAAtD,EAA0D;AACxD,YAAME,QAAQ,GAAG,EAAjB;AACA,YAAMC,UAAU,GAAGP,KAAK,CAACI,EAAD,CAAxB;AACA,YAAMI,WAAqB,GAAG;AAC5B/C,UAAAA,EAAE,EAAE,IADwB;AAE5BgD,UAAAA,eAAe,EAAE,KAFW;AAG5BzC,UAAAA,IAAI,EAAEsB,mBAAmB,CAACU,KAAK,CAACI,EAAC,GAAG,CAAL,CAAL,CAAaxB,YAAd,CAHG;AAI5B/C,UAAAA,KAAK,EAAErB,SAJqB;AAK5BkG,UAAAA,QAAQ,EAAEJ;AALkB,SAA9B;;AAQA,YAAIZ,kBAAJ,EAAwB;AACtBc,UAAAA,WAAU,CAACG,UAAX,GAAwB;AACtBC,YAAAA,UAAU,EAAEL,UAAU,CAACK,UADD;AAEtBC,YAAAA,YAAY,EAAEN,UAAU,CAACM,YAFH;AAGtBjC,YAAAA,YAAY,EAAE2B,UAAU,CAAC3B,YAHH;AAItBkC,YAAAA,QAAQ,EAAEP,UAAU,CAACO;AAJC,WAAxB;AAMD;;AAEDjB,QAAAA,aAAa,CAACjE,IAAd,CAAmB4E,WAAnB;AACAT,QAAAA,eAAe,CAACnE,IAAhB,CAAqBiE,aAArB;AACAA,QAAAA,aAAa,GAAGS,QAAhB;AACD;;AACDV,MAAAA,SAAS,GAAGI,KAAZ;AACD;;AApD0C,QAqDpChF,SArDoC,GAqDvBF,IArDuB,CAqDpCE,SArDoC;AAwD3C;;AACA,QAAMyC,EAAE,GACNzC,SAAS,KAAK,SAAd,IAA2BA,SAAS,KAAK,YAAzC,GACI,IADJ,GAEI8E,YAAY,EAHlB,CAzD2C;;AA+D3C,QAAMW,eAAe,GAAGzF,SAAS,KAAK,SAAd,IAA2BA,SAAS,KAAK,OAAjE;AACA,QAAMwF,UAAqB,GAAG;AAC5B/C,MAAAA,EAAE,EAAFA,EAD4B;AAE5BgD,MAAAA,eAAe,EAAfA,eAF4B;AAG5BzC,MAAAA,IAAI,EAAEhD,SAHsB;AAI5Ba,MAAAA,KAAK,EAAEf,IAAI,CAACe,KAJgB;AAK5B6E,MAAAA,QAAQ,EAAE;AALkB,KAA9B;;AAQA,QAAIhB,kBAAJ,EAAwB;AACtB,UAAMiB,UAAsB,GAAG;AAC7BC,QAAAA,UAAU,EAAE,IADiB;AAE7BhC,QAAAA,YAAY,EAAE,IAFe;AAG7BkC,QAAAA,QAAQ,EAAE,IAHmB;AAI7BD,QAAAA,YAAY,EAAE;AAJe,OAA/B;;AAMA,UAAIb,KAAK,IAAIA,KAAK,CAACnF,MAAN,IAAgB,CAA7B,EAAgC;AAC9B,YAAM0F,WAAU,GAAGP,KAAK,CAAC,CAAD,CAAxB;AACAW,QAAAA,UAAU,CAACC,UAAX,GAAwBL,WAAU,CAACK,UAAnC;AACAD,QAAAA,UAAU,CAAC/B,YAAX,GAA0B2B,WAAU,CAAC3B,YAArC;AACA+B,QAAAA,UAAU,CAACG,QAAX,GAAsBP,WAAU,CAACO,QAAjC;AACAH,QAAAA,UAAU,CAACE,YAAX,GAA0BN,WAAU,CAACM,YAArC;AACD;;AAEDL,MAAAA,UAAU,CAACG,UAAX,GAAwBA,UAAxB;AACD;;AAEDd,IAAAA,aAAa,CAACjE,IAAd,CAAmB4E,UAAnB;AACD,GAjGU;;;AAoGXO,EAAAA,kBAAkB,CAACpB,YAAD,EAAe,IAAf,CAAlB;AAEA,SAAOA,YAAP;AACD;AAGD;AACA;AACA;AACA;;;AACA,SAASoB,kBAAT,CACEC,SADF,EAEEC,eAFF,EAGQ;AACN,MAAMC,oBAAsC,GAAG,EAA/C;;AAEA,OAAK,IAAItG,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGoG,SAAS,CAACnG,MAA9B,EAAsCD,CAAC,EAAvC,EAA2C;AACzC,QAAMuG,SAAS,GAAGH,SAAS,CAACpG,CAAD,CAA3B;;AACA,QAAIuG,SAAS,CAACnD,IAAV,KAAmB,YAAnB,IAAmCmD,SAAS,CAACT,QAAV,CAAmB7F,MAAnB,KAA8B,CAArE,EAAwE;AACtEmG,MAAAA,SAAS,CAACI,MAAV,CAAiBxG,CAAjB,EAAoB,CAApB;AACAA,MAAAA,CAAC;AACDsG,MAAAA,oBAAoB,CAACtF,IAArB,CAA0BuF,SAA1B;AACD,KAJD,MAIO;AACLJ,MAAAA,kBAAkB,CAACI,SAAS,CAACT,QAAX,EAAqBS,SAArB,CAAlB;AACD;AACF,GAZK;AAeN;AACA;;;AACA,MAAIF,eAAe,KAAK,IAAxB,EAA8B;AAC5B,QAAIC,oBAAoB,CAACrG,MAArB,KAAgC,CAApC,EAAuC;AACrCoG,MAAAA,eAAe,CAACpF,KAAhB,GAAwBqF,oBAAoB,CAAC,CAAD,CAApB,CAAwBrF,KAAhD;AACD,KAFD,MAEO,IAAIqF,oBAAoB,CAACrG,MAArB,GAA8B,CAAlC,EAAqC;AAC1CoG,MAAAA,eAAe,CAACpF,KAAhB,GAAwBqF,oBAAoB,CAACG,GAArB,CAAyB;AAAA,YAAExF,KAAF,QAAEA,KAAF;AAAA,eAAaA,KAAb;AAAA,OAAzB,CAAxB;AACD;AACF;AACF;;AAED,SAASyF,yBAAT,CAAmCvD,KAAnC,EAAqD;AACnD;AACA,MACEA,KAAK,YAAYtC,KAAjB,IACAsC,KAAK,CAACC,IAAN,KAAe,qCAFjB,EAGE;AACA,UAAMD,KAAN;AACD,GAPkD;AASnD;AACA;AACA;AACA;;;AACA,MAAMwD,YAAY,GAAG,IAAI9F,KAAJ,CAAU,qCAAV,EAAiD;AACpE+F,IAAAA,KAAK,EAAEzD;AAD6D,GAAjD,CAArB,CAbmD;AAiBnD;;AACAwD,EAAAA,YAAY,CAACvD,IAAb,GAAoB,4BAApB,CAlBmD;;AAoBnDuD,EAAAA,YAAY,CAACC,KAAb,GAAqBzD,KAArB;AACA,QAAMwD,YAAN;AACD;;AAED,AAAO,SAASE,YAAT,CACLC,cADK,EAELC,KAFK,EAGLC,iBAHK,EAKM;AAAA,MADXlC,kBACW,uEADoB,KACpB;;AACX;AACA;AACA,MAAIkC,iBAAiB,IAAI,IAAzB,EAA+B;AAC7BA,IAAAA,iBAAiB,GAAG7I,oBAAoB,CAAC8I,sBAAzC;AACD;;AAED,MAAMC,kBAAkB,GAAGF,iBAAiB,CAACrF,OAA7C;AACA,MAAI7C,WAAJ;AACAkI,EAAAA,iBAAiB,CAACrF,OAAlB,GAA4B0B,eAA5B;AACA,MAAI8D,kBAAJ;;AACA,MAAI;AACFA,IAAAA,kBAAkB,GAAG,IAAItG,KAAJ,EAArB;AACAiG,IAAAA,cAAc,CAACC,KAAD,CAAd;AACD,GAHD,CAGE,OAAO5D,KAAP,EAAc;AACduD,IAAAA,yBAAyB,CAACvD,KAAD,CAAzB;AACD,GALD,SAKU;AACRrE,IAAAA,WAAW,GAAGL,OAAd;AACAA,IAAAA,OAAO,GAAG,EAAV;AACAuI,IAAAA,iBAAiB,CAACrF,OAAlB,GAA4BuF,kBAA5B;AACD;;AACD,MAAMxD,SAAS,GAAGrD,gBAAgB,CAACC,KAAjB,CAAuB6G,kBAAvB,CAAlB;AACA,SAAOtC,SAAS,CAACnB,SAAD,EAAY5E,WAAZ,EAAyBgG,kBAAzB,CAAhB;AACD;;AAED,SAASsC,aAAT,CAAuBC,UAAvB,EAAgEC,KAAhE,EAA8E;AAC5E,MAAI3F,OAAO,GAAG2F,KAAd;;AACA,SAAO3F,OAAP,EAAgB;AACd,QAAIA,OAAO,CAAC4F,GAAR,KAAgBjJ,eAApB,EAAqC;AACnC,UAAMkJ,YAAoC,GAAG7F,OAAO,CAAC8F,IAArD;AACA,UAAM1G,OAA0B,GAAGyG,YAAY,CAACE,QAAhD;;AACA,UAAI,CAACL,UAAU,CAACM,GAAX,CAAe5G,OAAf,CAAL,EAA8B;AAC5B;AACAsG,QAAAA,UAAU,CAAClH,GAAX,CAAeY,OAAf,EAAwBA,OAAO,CAAC9B,aAAhC,EAF4B;;AAI5B8B,QAAAA,OAAO,CAAC9B,aAAR,GAAwB0C,OAAO,CAACiG,aAAR,CAAsB3G,KAA9C;AACD;AACF;;AACDU,IAAAA,OAAO,GAAGA,OAAO,CAACkG,MAAlB;AACD;AACF;;AAED,SAASC,eAAT,CAAyBT,UAAzB,EAAkE;AAChEA,EAAAA,UAAU,CAACU,OAAX,CAAmB,UAAC9G,KAAD,EAAQF,OAAR;AAAA,WAAqBA,OAAO,CAAC9B,aAAR,GAAwBgC,KAA7C;AAAA,GAAnB;AACD;;AAED,SAAS+G,wBAAT,CACElB,cADF,EAEEC,KAFF,EAGErF,GAHF,EAIEsF,iBAJF,EAKElC,kBALF,EAMa;AACX,MAAMoC,kBAAkB,GAAGF,iBAAiB,CAACrF,OAA7C;AACA,MAAI7C,WAAJ;AACAkI,EAAAA,iBAAiB,CAACrF,OAAlB,GAA4B0B,eAA5B;AACA,MAAI8D,kBAAJ;;AACA,MAAI;AACFA,IAAAA,kBAAkB,GAAG,IAAItG,KAAJ,EAArB;AACAiG,IAAAA,cAAc,CAACC,KAAD,EAAQrF,GAAR,CAAd;AACD,GAHD,CAGE,OAAOyB,KAAP,EAAc;AACduD,IAAAA,yBAAyB,CAACvD,KAAD,CAAzB;AACD,GALD,SAKU;AACRrE,IAAAA,WAAW,GAAGL,OAAd;AACAA,IAAAA,OAAO,GAAG,EAAV;AACAuI,IAAAA,iBAAiB,CAACrF,OAAlB,GAA4BuF,kBAA5B;AACD;;AACD,MAAMxD,SAAS,GAAGrD,gBAAgB,CAACC,KAAjB,CAAuB6G,kBAAvB,CAAlB;AACA,SAAOtC,SAAS,CAACnB,SAAD,EAAY5E,WAAZ,EAAyBgG,kBAAzB,CAAhB;AACD;;AAED,SAASmD,mBAAT,CAA6BC,SAA7B,EAAwCC,SAAxC,EAAmD;AACjD,MAAID,SAAS,IAAIA,SAAS,CAACE,YAA3B,EAAyC;AACvC;AACA,QAAMrB,KAAK,GAAG9I,MAAM,CAAC,EAAD,EAAKkK,SAAL,CAApB;AACA,QAAMC,YAAY,GAAGF,SAAS,CAACE,YAA/B;;AACA,SAAK,IAAMC,QAAX,IAAuBD,YAAvB,EAAqC;AACnC,UAAIrB,KAAK,CAACsB,QAAD,CAAL,KAAoBzI,SAAxB,EAAmC;AACjCmH,QAAAA,KAAK,CAACsB,QAAD,CAAL,GAAkBD,YAAY,CAACC,QAAD,CAA9B;AACD;AACF;;AACD,WAAOtB,KAAP;AACD;;AACD,SAAOoB,SAAP;AACD;;AAED,AAAO,SAASG,mBAAT,CACLhB,KADK,EAELN,iBAFK,EAIL;AAAA,MADAlC,kBACA,uEAD+B,KAC/B;;AACA;AACA;AACA,MAAIkC,iBAAiB,IAAI,IAAzB,EAA+B;AAC7BA,IAAAA,iBAAiB,GAAG7I,oBAAoB,CAAC8I,sBAAzC;AACD;;AAED,MACEK,KAAK,CAACC,GAAN,KAAclJ,iBAAd,IACAiJ,KAAK,CAACC,GAAN,KAAc/I,mBADd,IAEA8I,KAAK,CAACC,GAAN,KAAchJ,UAHhB,EAIE;AACA,UAAM,IAAIsC,KAAJ,CACJ,mEADI,CAAN;AAGD,GAfD;;;AAiBAlC,EAAAA,sBAAsB;AACtB,MAAM8I,IAAI,GAAGH,KAAK,CAACG,IAAnB;AACA,MAAIV,KAAK,GAAGO,KAAK,CAACM,aAAlB;;AACA,MAAIH,IAAI,KAAKH,KAAK,CAACiB,WAAnB,EAAgC;AAC9BxB,IAAAA,KAAK,GAAGkB,mBAAmB,CAACR,IAAD,EAAOV,KAAP,CAA3B;AACD,GAtBD;AAwBA;;;AACAvG,EAAAA,WAAW,GAAI8G,KAAK,CAAClG,aAArB;AACA,MAAMiG,UAAU,GAAG,IAAIxI,GAAJ,EAAnB;;AACA,MAAI;AACFuI,IAAAA,aAAa,CAACC,UAAD,EAAaC,KAAb,CAAb;;AACA,QAAIA,KAAK,CAACC,GAAN,KAAchJ,UAAlB,EAA8B;AAC5B,aAAOyJ,wBAAwB,CAC7BP,IAAI,CAACe,MADwB,EAE7BzB,KAF6B,EAG7BO,KAAK,CAAC5F,GAHuB,EAI7BsF,iBAJ6B,EAK7BlC,kBAL6B,CAA/B;AAOD;;AACD,WAAO+B,YAAY,CAACY,IAAD,EAAOV,KAAP,EAAcC,iBAAd,EAAiClC,kBAAjC,CAAnB;AACD,GAZD,SAYU;AACRtE,IAAAA,WAAW,GAAG,IAAd;AACAsH,IAAAA,eAAe,CAACT,UAAD,CAAf;AACD;AACF;;;;;"}