{"version":3,"file":"react-dom-unstable-fizz.browser.development.js","sources":["../../../../packages/react-server/src/ReactServerStreamConfigBrowser.js","../../../../packages/react-server/src/ReactDOMServerFormatConfig.js","../../../../packages/shared/ReactSymbols.js","../../../../packages/react-server/src/ReactFizzServer.js","../../../../packages/react-dom/src/server/ReactDOMFizzServerBrowser.js"],"sourcesContent":["/**\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\nexport type Destination = ReadableStreamController;\n\nexport function scheduleWork(callback: () => void) {\n  callback();\n}\n\nexport function flushBuffered(destination: Destination) {\n  // WHATWG Streams do not yet have a way to flush the underlying\n  // transform streams. https://github.com/whatwg/streams/issues/960\n}\n\nexport function beginWriting(destination: Destination) {}\n\nexport function writeChunk(\n  destination: Destination,\n  buffer: Uint8Array,\n): boolean {\n  destination.enqueue(buffer);\n  return destination.desiredSize > 0;\n}\n\nexport function completeWriting(destination: Destination) {}\n\nexport function close(destination: Destination) {\n  destination.close();\n}\n\nconst textEncoder = new TextEncoder();\n\nexport function convertStringToBuffer(content: string): Uint8Array {\n  return textEncoder.encode(content);\n}\n","/**\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\nimport {convertStringToBuffer} from 'react-server/src/ReactServerStreamConfig';\n\nexport function formatChunkAsString(type: string, props: Object): string {\n  let str = '<' + type + '>';\n  if (typeof props.children === 'string') {\n    str += props.children;\n  }\n  str += '</' + type + '>';\n  return str;\n}\n\nexport function formatChunk(type: string, props: Object): Uint8Array {\n  return convertStringToBuffer(formatChunkAsString(type, props));\n}\n","/**\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\n// ATTENTION\n// When adding new symbols to this file,\n// Please consider also adding to 'react-devtools-shared/src/backend/ReactSymbols'\n\n// The Symbol used to tag the ReactElement-like types. If there is no native Symbol\n// nor polyfill, then a plain number is used for performance.\nexport let REACT_ELEMENT_TYPE = 0xeac7;\nexport let REACT_PORTAL_TYPE = 0xeaca;\nexport let REACT_FRAGMENT_TYPE = 0xeacb;\nexport let REACT_STRICT_MODE_TYPE = 0xeacc;\nexport let REACT_PROFILER_TYPE = 0xead2;\nexport let REACT_PROVIDER_TYPE = 0xeacd;\nexport let REACT_CONTEXT_TYPE = 0xeace;\nexport let REACT_FORWARD_REF_TYPE = 0xead0;\nexport let REACT_SUSPENSE_TYPE = 0xead1;\nexport let REACT_SUSPENSE_LIST_TYPE = 0xead8;\nexport let REACT_MEMO_TYPE = 0xead3;\nexport let REACT_LAZY_TYPE = 0xead4;\nexport let REACT_BLOCK_TYPE = 0xead9;\nexport let REACT_SERVER_BLOCK_TYPE = 0xeada;\nexport let REACT_FUNDAMENTAL_TYPE = 0xead5;\nexport let REACT_SCOPE_TYPE = 0xead7;\nexport let REACT_OPAQUE_ID_TYPE = 0xeae0;\nexport let REACT_DEBUG_TRACING_MODE_TYPE = 0xeae1;\nexport let REACT_OFFSCREEN_TYPE = 0xeae2;\nexport let REACT_LEGACY_HIDDEN_TYPE = 0xeae3;\n\nif (typeof Symbol === 'function' && Symbol.for) {\n  const symbolFor = Symbol.for;\n  REACT_ELEMENT_TYPE = symbolFor('react.element');\n  REACT_PORTAL_TYPE = symbolFor('react.portal');\n  REACT_FRAGMENT_TYPE = symbolFor('react.fragment');\n  REACT_STRICT_MODE_TYPE = symbolFor('react.strict_mode');\n  REACT_PROFILER_TYPE = symbolFor('react.profiler');\n  REACT_PROVIDER_TYPE = symbolFor('react.provider');\n  REACT_CONTEXT_TYPE = symbolFor('react.context');\n  REACT_FORWARD_REF_TYPE = symbolFor('react.forward_ref');\n  REACT_SUSPENSE_TYPE = symbolFor('react.suspense');\n  REACT_SUSPENSE_LIST_TYPE = symbolFor('react.suspense_list');\n  REACT_MEMO_TYPE = symbolFor('react.memo');\n  REACT_LAZY_TYPE = symbolFor('react.lazy');\n  REACT_BLOCK_TYPE = symbolFor('react.block');\n  REACT_SERVER_BLOCK_TYPE = symbolFor('react.server.block');\n  REACT_FUNDAMENTAL_TYPE = symbolFor('react.fundamental');\n  REACT_SCOPE_TYPE = symbolFor('react.scope');\n  REACT_OPAQUE_ID_TYPE = symbolFor('react.opaque.id');\n  REACT_DEBUG_TRACING_MODE_TYPE = symbolFor('react.debug_trace_mode');\n  REACT_OFFSCREEN_TYPE = symbolFor('react.offscreen');\n  REACT_LEGACY_HIDDEN_TYPE = symbolFor('react.legacy_hidden');\n}\n\nconst MAYBE_ITERATOR_SYMBOL = typeof Symbol === 'function' && Symbol.iterator;\nconst FAUX_ITERATOR_SYMBOL = '@@iterator';\n\nexport function getIteratorFn(maybeIterable: ?any): ?() => ?Iterator<*> {\n  if (maybeIterable === null || typeof maybeIterable !== 'object') {\n    return null;\n  }\n  const maybeIterator =\n    (MAYBE_ITERATOR_SYMBOL && maybeIterable[MAYBE_ITERATOR_SYMBOL]) ||\n    maybeIterable[FAUX_ITERATOR_SYMBOL];\n  if (typeof maybeIterator === 'function') {\n    return maybeIterator;\n  }\n  return null;\n}\n","/**\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\nimport type {Destination} from './ReactServerStreamConfig';\nimport type {ReactNodeList} from 'shared/ReactTypes';\n\nimport {\n  scheduleWork,\n  beginWriting,\n  writeChunk,\n  completeWriting,\n  flushBuffered,\n  close,\n} from './ReactServerStreamConfig';\nimport {formatChunk} from './ReactServerFormatConfig';\nimport {REACT_ELEMENT_TYPE} from 'shared/ReactSymbols';\n\ntype OpaqueRequest = {\n  destination: Destination,\n  children: ReactNodeList,\n  completedChunks: Array<Uint8Array>,\n  flowing: boolean,\n  ...\n};\n\nexport function createRequest(\n  children: ReactNodeList,\n  destination: Destination,\n): OpaqueRequest {\n  return {destination, children, completedChunks: [], flowing: false};\n}\n\nfunction performWork(request: OpaqueRequest): void {\n  const element = (request.children: any);\n  request.children = null;\n  if (element && element.$$typeof !== REACT_ELEMENT_TYPE) {\n    return;\n  }\n  const type = element.type;\n  const props = element.props;\n  if (typeof type !== 'string') {\n    return;\n  }\n  request.completedChunks.push(formatChunk(type, props));\n  if (request.flowing) {\n    flushCompletedChunks(request);\n  }\n\n  flushBuffered(request.destination);\n}\n\nfunction flushCompletedChunks(request: OpaqueRequest) {\n  const destination = request.destination;\n  const chunks = request.completedChunks;\n  request.completedChunks = [];\n\n  beginWriting(destination);\n  try {\n    for (let i = 0; i < chunks.length; i++) {\n      const chunk = chunks[i];\n      writeChunk(destination, chunk);\n    }\n  } finally {\n    completeWriting(destination);\n  }\n  close(destination);\n}\n\nexport function startWork(request: OpaqueRequest): void {\n  request.flowing = true;\n  scheduleWork(() => performWork(request));\n}\n\nexport function startFlowing(request: OpaqueRequest): void {\n  request.flowing = false;\n  flushCompletedChunks(request);\n}\n","/**\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\nimport type {ReactNodeList} from 'shared/ReactTypes';\n\nimport {\n  createRequest,\n  startWork,\n  startFlowing,\n} from 'react-server/src/ReactFizzServer';\n\nfunction renderToReadableStream(children: ReactNodeList): ReadableStream {\n  let request;\n  return new ReadableStream({\n    start(controller) {\n      request = createRequest(children, controller);\n      startWork(request);\n    },\n    pull(controller) {\n      startFlowing(request);\n    },\n    cancel(reason) {},\n  });\n}\n\nexport {renderToReadableStream};\n"],"names":["scheduleWork","callback","flushBuffered","destination","writeChunk","buffer","enqueue","desiredSize","close","textEncoder","TextEncoder","convertStringToBuffer","content","encode","formatChunkAsString","type","props","str","children","formatChunk","REACT_ELEMENT_TYPE","REACT_PORTAL_TYPE","REACT_FRAGMENT_TYPE","REACT_STRICT_MODE_TYPE","REACT_PROFILER_TYPE","REACT_PROVIDER_TYPE","REACT_CONTEXT_TYPE","REACT_FORWARD_REF_TYPE","REACT_SUSPENSE_TYPE","REACT_SUSPENSE_LIST_TYPE","REACT_MEMO_TYPE","REACT_LAZY_TYPE","REACT_BLOCK_TYPE","REACT_SERVER_BLOCK_TYPE","REACT_FUNDAMENTAL_TYPE","REACT_SCOPE_TYPE","REACT_OPAQUE_ID_TYPE","REACT_DEBUG_TRACING_MODE_TYPE","REACT_OFFSCREEN_TYPE","REACT_LEGACY_HIDDEN_TYPE","Symbol","for","symbolFor","createRequest","completedChunks","flowing","performWork","request","element","$$typeof","push","flushCompletedChunks","chunks","beginWriting","i","length","chunk","completeWriting","startWork","startFlowing","renderToReadableStream","ReadableStream","start","controller","pull","cancel","reason"],"mappings":";;;;;;EAWO,SAASA,YAAT,CAAsBC,QAAtB,EAA4C;EACjDA,EAAAA,QAAQ;EACT;EAEM,SAASC,aAAT,CAAuBC,WAAvB,EAAiD;EAEtD;EACD;EAIM,SAASC,UAAT,CACLD,WADK,EAELE,MAFK,EAGI;EACTF,EAAAA,WAAW,CAACG,OAAZ,CAAoBD,MAApB;EACA,SAAOF,WAAW,CAACI,WAAZ,GAA0B,CAAjC;EACD;EAIM,SAASC,KAAT,CAAeL,WAAf,EAAyC;EAC9CA,EAAAA,WAAW,CAACK,KAAZ;EACD;EAED,IAAMC,WAAW,GAAG,IAAIC,WAAJ,EAApB;EAEO,SAASC,qBAAT,CAA+BC,OAA/B,EAA4D;EACjE,SAAOH,WAAW,CAACI,MAAZ,CAAmBD,OAAnB,CAAP;EACD;;EC7BM,SAASE,mBAAT,CAA6BC,IAA7B,EAA2CC,KAA3C,EAAkE;EACvE,MAAIC,GAAG,GAAG,MAAMF,IAAN,GAAa,GAAvB;;EACA,MAAI,OAAOC,KAAK,CAACE,QAAb,KAA0B,QAA9B,EAAwC;EACtCD,IAAAA,GAAG,IAAID,KAAK,CAACE,QAAb;EACD;;EACDD,EAAAA,GAAG,IAAI,OAAOF,IAAP,GAAc,GAArB;EACA,SAAOE,GAAP;EACD;AAED,EAAO,SAASE,WAAT,CAAqBJ,IAArB,EAAmCC,KAAnC,EAA8D;EACnE,SAAOL,qBAAqB,CAACG,mBAAmB,CAACC,IAAD,EAAOC,KAAP,CAApB,CAA5B;EACD;;ECbD;EACA;EACA;EAEA;EACA;AACA,EAAO,IAAII,kBAAkB,GAAG,MAAzB;AACP,EAAO,IAAIC,iBAAiB,GAAG,MAAxB;AACP,EAAO,IAAIC,mBAAmB,GAAG,MAA1B;AACP,EAAO,IAAIC,sBAAsB,GAAG,MAA7B;AACP,EAAO,IAAIC,mBAAmB,GAAG,MAA1B;AACP,EAAO,IAAIC,mBAAmB,GAAG,MAA1B;AACP,EAAO,IAAIC,kBAAkB,GAAG,MAAzB;AACP,EAAO,IAAIC,sBAAsB,GAAG,MAA7B;AACP,EAAO,IAAIC,mBAAmB,GAAG,MAA1B;AACP,EAAO,IAAIC,wBAAwB,GAAG,MAA/B;AACP,EAAO,IAAIC,eAAe,GAAG,MAAtB;AACP,EAAO,IAAIC,eAAe,GAAG,MAAtB;AACP,EAAO,IAAIC,gBAAgB,GAAG,MAAvB;AACP,EAAO,IAAIC,uBAAuB,GAAG,MAA9B;AACP,EAAO,IAAIC,sBAAsB,GAAG,MAA7B;AACP,EAAO,IAAIC,gBAAgB,GAAG,MAAvB;AACP,EAAO,IAAIC,oBAAoB,GAAG,MAA3B;AACP,EAAO,IAAIC,6BAA6B,GAAG,MAApC;AACP,EAAO,IAAIC,oBAAoB,GAAG,MAA3B;AACP,EAAO,IAAIC,wBAAwB,GAAG,MAA/B;;EAEP,IAAI,OAAOC,MAAP,KAAkB,UAAlB,IAAgCA,MAAM,CAACC,GAA3C,EAAgD;EAC9C,MAAMC,SAAS,GAAGF,MAAM,CAACC,GAAzB;EACArB,EAAAA,kBAAkB,GAAGsB,SAAS,CAAC,eAAD,CAA9B;EACArB,EAAAA,iBAAiB,GAAGqB,SAAS,CAAC,cAAD,CAA7B;EACApB,EAAAA,mBAAmB,GAAGoB,SAAS,CAAC,gBAAD,CAA/B;EACAnB,EAAAA,sBAAsB,GAAGmB,SAAS,CAAC,mBAAD,CAAlC;EACAlB,EAAAA,mBAAmB,GAAGkB,SAAS,CAAC,gBAAD,CAA/B;EACAjB,EAAAA,mBAAmB,GAAGiB,SAAS,CAAC,gBAAD,CAA/B;EACAhB,EAAAA,kBAAkB,GAAGgB,SAAS,CAAC,eAAD,CAA9B;EACAf,EAAAA,sBAAsB,GAAGe,SAAS,CAAC,mBAAD,CAAlC;EACAd,EAAAA,mBAAmB,GAAGc,SAAS,CAAC,gBAAD,CAA/B;EACAb,EAAAA,wBAAwB,GAAGa,SAAS,CAAC,qBAAD,CAApC;EACAZ,EAAAA,eAAe,GAAGY,SAAS,CAAC,YAAD,CAA3B;EACAX,EAAAA,eAAe,GAAGW,SAAS,CAAC,YAAD,CAA3B;EACAV,EAAAA,gBAAgB,GAAGU,SAAS,CAAC,aAAD,CAA5B;EACAT,EAAAA,uBAAuB,GAAGS,SAAS,CAAC,oBAAD,CAAnC;EACAR,EAAAA,sBAAsB,GAAGQ,SAAS,CAAC,mBAAD,CAAlC;EACAP,EAAAA,gBAAgB,GAAGO,SAAS,CAAC,aAAD,CAA5B;EACAN,EAAAA,oBAAoB,GAAGM,SAAS,CAAC,iBAAD,CAAhC;EACAL,EAAAA,6BAA6B,GAAGK,SAAS,CAAC,wBAAD,CAAzC;EACAJ,EAAAA,oBAAoB,GAAGI,SAAS,CAAC,iBAAD,CAAhC;EACAH,EAAAA,wBAAwB,GAAGG,SAAS,CAAC,qBAAD,CAApC;EACD;;EC3BM,SAASC,aAAT,CACLzB,QADK,EAELf,WAFK,EAGU;EACf,SAAO;EAACA,IAAAA,WAAW,EAAXA,WAAD;EAAce,IAAAA,QAAQ,EAARA,QAAd;EAAwB0B,IAAAA,eAAe,EAAE,EAAzC;EAA6CC,IAAAA,OAAO,EAAE;EAAtD,GAAP;EACD;;EAED,SAASC,WAAT,CAAqBC,OAArB,EAAmD;EACjD,MAAMC,OAAO,GAAID,OAAO,CAAC7B,QAAzB;EACA6B,EAAAA,OAAO,CAAC7B,QAAR,GAAmB,IAAnB;;EACA,MAAI8B,OAAO,IAAIA,OAAO,CAACC,QAAR,KAAqB7B,kBAApC,EAAwD;EACtD;EACD;;EACD,MAAML,IAAI,GAAGiC,OAAO,CAACjC,IAArB;EACA,MAAMC,KAAK,GAAGgC,OAAO,CAAChC,KAAtB;;EACA,MAAI,OAAOD,IAAP,KAAgB,QAApB,EAA8B;EAC5B;EACD;;EACDgC,EAAAA,OAAO,CAACH,eAAR,CAAwBM,IAAxB,CAA6B/B,WAAW,CAACJ,IAAD,EAAOC,KAAP,CAAxC;;EACA,MAAI+B,OAAO,CAACF,OAAZ,EAAqB;EACnBM,IAAAA,oBAAoB,CAACJ,OAAD,CAApB;EACD;;EAED7C,EAAAA,aAAa,CAAC6C,OAAO,CAAC5C,WAAT,CAAb;EACD;;EAED,SAASgD,oBAAT,CAA8BJ,OAA9B,EAAsD;EACpD,MAAM5C,WAAW,GAAG4C,OAAO,CAAC5C,WAA5B;EACA,MAAMiD,MAAM,GAAGL,OAAO,CAACH,eAAvB;EACAG,EAAAA,OAAO,CAACH,eAAR,GAA0B,EAA1B;AAEAS;EACA,MAAI;EACF,SAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGF,MAAM,CAACG,MAA3B,EAAmCD,CAAC,EAApC,EAAwC;EACtC,UAAME,KAAK,GAAGJ,MAAM,CAACE,CAAD,CAApB;EACAlD,MAAAA,UAAU,CAACD,WAAD,EAAcqD,KAAd,CAAV;EACD;EACF,GALD,SAKU;AACRC,EACD;;EACDjD,EAAAA,KAAK,CAACL,WAAD,CAAL;EACD;;AAED,EAAO,SAASuD,SAAT,CAAmBX,OAAnB,EAAiD;EACtDA,EAAAA,OAAO,CAACF,OAAR,GAAkB,IAAlB;EACA7C,EAAAA,YAAY,CAAC;EAAA,WAAM8C,WAAW,CAACC,OAAD,CAAjB;EAAA,GAAD,CAAZ;EACD;AAED,EAAO,SAASY,YAAT,CAAsBZ,OAAtB,EAAoD;EACzDA,EAAAA,OAAO,CAACF,OAAR,GAAkB,KAAlB;EACAM,EAAAA,oBAAoB,CAACJ,OAAD,CAApB;EACD;;ECjED,SAASa,sBAAT,CAAgC1C,QAAhC,EAAyE;EACvE,MAAI6B,OAAJ;EACA,SAAO,IAAIc,cAAJ,CAAmB;EACxBC,IAAAA,KADwB,YAClBC,UADkB,EACN;EAChBhB,MAAAA,OAAO,GAAGJ,aAAa,CAACzB,QAAD,EAAW6C,UAAX,CAAvB;EACAL,MAAAA,SAAS,CAACX,OAAD,CAAT;EACD,KAJuB;EAKxBiB,IAAAA,IALwB,YAKnBD,UALmB,EAKP;EACfJ,MAAAA,YAAY,CAACZ,OAAD,CAAZ;EACD,KAPuB;EAQxBkB,IAAAA,MARwB,YAQjBC,MARiB,EAQT;EARS,GAAnB,CAAP;EAUD;;;;;;;;"}