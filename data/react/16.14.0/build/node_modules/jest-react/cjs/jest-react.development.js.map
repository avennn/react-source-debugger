{"version":3,"file":"jest-react.development.js","sources":["../../../../packages/shared/ReactSymbols.js","../../../../packages/jest-react/src/JestReact.js"],"sourcesContent":["/**\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\n// ATTENTION\n// When adding new symbols to this file,\n// Please consider also adding to 'react-devtools-shared/src/backend/ReactSymbols'\n\n// The Symbol used to tag the ReactElement-like types. If there is no native Symbol\n// nor polyfill, then a plain number is used for performance.\nexport let REACT_ELEMENT_TYPE = 0xeac7;\nexport let REACT_PORTAL_TYPE = 0xeaca;\nexport let REACT_FRAGMENT_TYPE = 0xeacb;\nexport let REACT_STRICT_MODE_TYPE = 0xeacc;\nexport let REACT_PROFILER_TYPE = 0xead2;\nexport let REACT_PROVIDER_TYPE = 0xeacd;\nexport let REACT_CONTEXT_TYPE = 0xeace;\nexport let REACT_FORWARD_REF_TYPE = 0xead0;\nexport let REACT_SUSPENSE_TYPE = 0xead1;\nexport let REACT_SUSPENSE_LIST_TYPE = 0xead8;\nexport let REACT_MEMO_TYPE = 0xead3;\nexport let REACT_LAZY_TYPE = 0xead4;\nexport let REACT_BLOCK_TYPE = 0xead9;\nexport let REACT_SERVER_BLOCK_TYPE = 0xeada;\nexport let REACT_FUNDAMENTAL_TYPE = 0xead5;\nexport let REACT_SCOPE_TYPE = 0xead7;\nexport let REACT_OPAQUE_ID_TYPE = 0xeae0;\nexport let REACT_DEBUG_TRACING_MODE_TYPE = 0xeae1;\nexport let REACT_OFFSCREEN_TYPE = 0xeae2;\nexport let REACT_LEGACY_HIDDEN_TYPE = 0xeae3;\n\nif (typeof Symbol === 'function' && Symbol.for) {\n  const symbolFor = Symbol.for;\n  REACT_ELEMENT_TYPE = symbolFor('react.element');\n  REACT_PORTAL_TYPE = symbolFor('react.portal');\n  REACT_FRAGMENT_TYPE = symbolFor('react.fragment');\n  REACT_STRICT_MODE_TYPE = symbolFor('react.strict_mode');\n  REACT_PROFILER_TYPE = symbolFor('react.profiler');\n  REACT_PROVIDER_TYPE = symbolFor('react.provider');\n  REACT_CONTEXT_TYPE = symbolFor('react.context');\n  REACT_FORWARD_REF_TYPE = symbolFor('react.forward_ref');\n  REACT_SUSPENSE_TYPE = symbolFor('react.suspense');\n  REACT_SUSPENSE_LIST_TYPE = symbolFor('react.suspense_list');\n  REACT_MEMO_TYPE = symbolFor('react.memo');\n  REACT_LAZY_TYPE = symbolFor('react.lazy');\n  REACT_BLOCK_TYPE = symbolFor('react.block');\n  REACT_SERVER_BLOCK_TYPE = symbolFor('react.server.block');\n  REACT_FUNDAMENTAL_TYPE = symbolFor('react.fundamental');\n  REACT_SCOPE_TYPE = symbolFor('react.scope');\n  REACT_OPAQUE_ID_TYPE = symbolFor('react.opaque.id');\n  REACT_DEBUG_TRACING_MODE_TYPE = symbolFor('react.debug_trace_mode');\n  REACT_OFFSCREEN_TYPE = symbolFor('react.offscreen');\n  REACT_LEGACY_HIDDEN_TYPE = symbolFor('react.legacy_hidden');\n}\n\nconst MAYBE_ITERATOR_SYMBOL = typeof Symbol === 'function' && Symbol.iterator;\nconst FAUX_ITERATOR_SYMBOL = '@@iterator';\n\nexport function getIteratorFn(maybeIterable: ?any): ?() => ?Iterator<*> {\n  if (maybeIterable === null || typeof maybeIterable !== 'object') {\n    return null;\n  }\n  const maybeIterator =\n    (MAYBE_ITERATOR_SYMBOL && maybeIterable[MAYBE_ITERATOR_SYMBOL]) ||\n    maybeIterable[FAUX_ITERATOR_SYMBOL];\n  if (typeof maybeIterator === 'function') {\n    return maybeIterator;\n  }\n  return null;\n}\n","/**\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport {REACT_ELEMENT_TYPE, REACT_FRAGMENT_TYPE} from 'shared/ReactSymbols';\n\nimport invariant from 'shared/invariant';\n\nfunction captureAssertion(fn) {\n  // Trick to use a Jest matcher inside another Jest matcher. `fn` contains an\n  // assertion; if it throws, we capture the error and return it, so the stack\n  // trace presented to the user points to the original assertion in the\n  // test file.\n  try {\n    fn();\n  } catch (error) {\n    return {\n      pass: false,\n      message: () => error.message,\n    };\n  }\n  return {pass: true};\n}\n\nfunction assertYieldsWereCleared(root) {\n  const Scheduler = root._Scheduler;\n  const actualYields = Scheduler.unstable_clearYields();\n  invariant(\n    actualYields.length === 0,\n    'Log of yielded values is not empty. ' +\n      'Call expect(ReactTestRenderer).unstable_toHaveYielded(...) first.',\n  );\n}\n\nexport function unstable_toMatchRenderedOutput(root, expectedJSX) {\n  assertYieldsWereCleared(root);\n  const actualJSON = root.toJSON();\n\n  let actualJSX;\n  if (actualJSON === null || typeof actualJSON === 'string') {\n    actualJSX = actualJSON;\n  } else if (Array.isArray(actualJSON)) {\n    if (actualJSON.length === 0) {\n      actualJSX = null;\n    } else if (actualJSON.length === 1) {\n      actualJSX = jsonChildToJSXChild(actualJSON[0]);\n    } else {\n      const actualJSXChildren = jsonChildrenToJSXChildren(actualJSON);\n      if (actualJSXChildren === null || typeof actualJSXChildren === 'string') {\n        actualJSX = actualJSXChildren;\n      } else {\n        actualJSX = {\n          $$typeof: REACT_ELEMENT_TYPE,\n          type: REACT_FRAGMENT_TYPE,\n          key: null,\n          ref: null,\n          props: {\n            children: actualJSXChildren,\n          },\n          _owner: null,\n          _store: __DEV__ ? {} : undefined,\n        };\n      }\n    }\n  } else {\n    actualJSX = jsonChildToJSXChild(actualJSON);\n  }\n\n  return captureAssertion(() => {\n    expect(actualJSX).toEqual(expectedJSX);\n  });\n}\n\nfunction jsonChildToJSXChild(jsonChild) {\n  if (jsonChild === null || typeof jsonChild === 'string') {\n    return jsonChild;\n  } else {\n    const jsxChildren = jsonChildrenToJSXChildren(jsonChild.children);\n    return {\n      $$typeof: REACT_ELEMENT_TYPE,\n      type: jsonChild.type,\n      key: null,\n      ref: null,\n      props:\n        jsxChildren === null\n          ? jsonChild.props\n          : {...jsonChild.props, children: jsxChildren},\n      _owner: null,\n      _store: __DEV__ ? {} : undefined,\n    };\n  }\n}\n\nfunction jsonChildrenToJSXChildren(jsonChildren) {\n  if (jsonChildren !== null) {\n    if (jsonChildren.length === 1) {\n      return jsonChildToJSXChild(jsonChildren[0]);\n    } else if (jsonChildren.length > 1) {\n      const jsxChildren = [];\n      let allJSXChildrenAreStrings = true;\n      let jsxChildrenString = '';\n      for (let i = 0; i < jsonChildren.length; i++) {\n        const jsxChild = jsonChildToJSXChild(jsonChildren[i]);\n        jsxChildren.push(jsxChild);\n        if (allJSXChildrenAreStrings) {\n          if (typeof jsxChild === 'string') {\n            jsxChildrenString += jsxChild;\n          } else if (jsxChild !== null) {\n            allJSXChildrenAreStrings = false;\n          }\n        }\n      }\n      return allJSXChildrenAreStrings ? jsxChildrenString : jsxChildren;\n    }\n  }\n  return null;\n}\n"],"names":["REACT_ELEMENT_TYPE","REACT_PORTAL_TYPE","REACT_FRAGMENT_TYPE","REACT_STRICT_MODE_TYPE","REACT_PROFILER_TYPE","REACT_PROVIDER_TYPE","REACT_CONTEXT_TYPE","REACT_FORWARD_REF_TYPE","REACT_SUSPENSE_TYPE","REACT_SUSPENSE_LIST_TYPE","REACT_MEMO_TYPE","REACT_LAZY_TYPE","REACT_BLOCK_TYPE","REACT_SERVER_BLOCK_TYPE","REACT_FUNDAMENTAL_TYPE","REACT_SCOPE_TYPE","REACT_OPAQUE_ID_TYPE","REACT_DEBUG_TRACING_MODE_TYPE","REACT_OFFSCREEN_TYPE","REACT_LEGACY_HIDDEN_TYPE","Symbol","for","symbolFor","captureAssertion","fn","error","pass","message","assertYieldsWereCleared","root","Scheduler","_Scheduler","actualYields","unstable_clearYields","length","unstable_toMatchRenderedOutput","expectedJSX","actualJSON","toJSON","actualJSX","Array","isArray","jsonChildToJSXChild","actualJSXChildren","jsonChildrenToJSXChildren","$$typeof","type","key","ref","props","children","_owner","_store","__DEV__","expect","toEqual","jsonChild","jsxChildren","jsonChildren","allJSXChildrenAreStrings","jsxChildrenString","i","jsxChild","push"],"mappings":"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"}