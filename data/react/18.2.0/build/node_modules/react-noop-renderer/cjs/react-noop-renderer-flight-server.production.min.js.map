{"version":3,"file":"react-noop-renderer-flight-server.production.min.js","sources":["../../../../packages/react-noop-renderer/src/ReactNoopFlightServer.js"],"sourcesContent":["/**\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\n/**\n * This is a renderer of React that doesn't have a render target output.\n * It is useful to demonstrate the internals of the reconciler in isolation\n * and for testing semantics of reconciliation separate from the host\n * environment.\n */\n\nimport type {ReactModel} from 'react-server/src/ReactFlightServer';\nimport type {ServerContextJSONValue} from 'shared/ReactTypes';\n\nimport {saveModule} from 'react-noop-renderer/flight-modules';\n\nimport ReactFlightServer from 'react-server/flight';\n\ntype Destination = Array<string>;\n\nconst ReactNoopFlightServer = ReactFlightServer({\n  scheduleWork(callback: () => void) {\n    callback();\n  },\n  beginWriting(destination: Destination): void {},\n  writeChunk(destination: Destination, chunk: string): void {\n    destination.push(chunk);\n  },\n  writeChunkAndReturn(destination: Destination, chunk: string): boolean {\n    destination.push(chunk);\n    return true;\n  },\n  completeWriting(destination: Destination): void {},\n  close(destination: Destination): void {},\n  closeWithError(destination: Destination, error: mixed): void {},\n  flushBuffered(destination: Destination): void {},\n  stringToChunk(content: string): string {\n    return content;\n  },\n  stringToPrecomputedChunk(content: string): string {\n    return content;\n  },\n  isModuleReference(reference: Object): boolean {\n    return reference.$$typeof === Symbol.for('react.module.reference');\n  },\n  getModuleKey(reference: Object): Object {\n    return reference;\n  },\n  resolveModuleMetaData(\n    config: void,\n    reference: {$$typeof: Symbol, value: any},\n  ) {\n    return saveModule(reference.value);\n  },\n});\n\ntype Options = {\n  onError?: (error: mixed) => void,\n  context?: Array<[string, ServerContextJSONValue]>,\n  identifierPrefix?: string,\n};\n\nfunction render(model: ReactModel, options?: Options): Destination {\n  const destination: Destination = [];\n  const bundlerConfig = undefined;\n  const request = ReactNoopFlightServer.createRequest(\n    model,\n    bundlerConfig,\n    options ? options.onError : undefined,\n    options ? options.context : undefined,\n    options ? options.identifierPrefix : undefined,\n  );\n  ReactNoopFlightServer.startWork(request);\n  ReactNoopFlightServer.startFlowing(request, destination);\n  return destination;\n}\n\nexport {render};\n"],"names":["ReactNoopFlightServer","ReactFlightServer","scheduleWork","callback","beginWriting","destination","writeChunk","chunk","push","writeChunkAndReturn","completeWriting","close","closeWithError","error","flushBuffered","stringToChunk","content","stringToPrecomputedChunk","isModuleReference","reference","$$typeof","Symbol","for","getModuleKey","resolveModuleMetaData","config","saveModule","value","render","model","options","bundlerConfig","undefined","request","createRequest","onError","context","identifierPrefix","startWork","startFlowing"],"mappings":";;;;;AASA;;;;;;AAgBA,MAAMA,qBAAqB,GAAGC,iBAAiB,CAAC;AAC9CC,EAAAA,YAAY,CAACC,QAAD,EAAuB;AACjCA,IAAAA,QAAQ;AACT,GAH6C;;AAI9CC,EAAAA,YAAY,CAACC,WAAD,EAAiC,EAJC;;AAK9CC,EAAAA,UAAU,CAACD,WAAD,EAA2BE,KAA3B,EAAgD;AACxDF,IAAAA,WAAW,CAACG,IAAZ,CAAiBD,KAAjB;AACD,GAP6C;;AAQ9CE,EAAAA,mBAAmB,CAACJ,WAAD,EAA2BE,KAA3B,EAAmD;AACpEF,IAAAA,WAAW,CAACG,IAAZ,CAAiBD,KAAjB;AACA,WAAO,IAAP;AACD,GAX6C;;AAY9CG,EAAAA,eAAe,CAACL,WAAD,EAAiC,EAZF;;AAa9CM,EAAAA,KAAK,CAACN,WAAD,EAAiC,EAbQ;;AAc9CO,EAAAA,cAAc,CAACP,WAAD,EAA2BQ,KAA3B,EAA+C,EAdf;;AAe9CC,EAAAA,aAAa,CAACT,WAAD,EAAiC,EAfA;;AAgB9CU,EAAAA,aAAa,CAACC,OAAD,EAA0B;AACrC,WAAOA,OAAP;AACD,GAlB6C;;AAmB9CC,EAAAA,wBAAwB,CAACD,OAAD,EAA0B;AAChD,WAAOA,OAAP;AACD,GArB6C;;AAsB9CE,EAAAA,iBAAiB,CAACC,SAAD,EAA6B;AAC5C,WAAOA,SAAS,CAACC,QAAV,KAAuBC,MAAM,CAACC,GAAP,CAAW,wBAAX,CAA9B;AACD,GAxB6C;;AAyB9CC,EAAAA,YAAY,CAACJ,SAAD,EAA4B;AACtC,WAAOA,SAAP;AACD,GA3B6C;;AA4B9CK,EAAAA,qBAAqB,CACnBC,MADmB,EAEnBN,SAFmB,EAGnB;AACA,WAAOO,wBAAU,CAACP,SAAS,CAACQ,KAAX,CAAjB;AACD;;AAjC6C,CAAD,CAA/C;;AA0CA,SAASC,MAAT,CAAgBC,KAAhB,EAAmCC,OAAnC,EAAmE;AACjE,QAAMzB,WAAwB,GAAG,EAAjC;AACA,QAAM0B,aAAa,GAAGC,SAAtB;AACA,QAAMC,OAAO,GAAGjC,qBAAqB,CAACkC,aAAtB,CACdL,KADc,EAEdE,aAFc,EAGdD,OAAO,GAAGA,OAAO,CAACK,OAAX,GAAqBH,SAHd,EAIdF,OAAO,GAAGA,OAAO,CAACM,OAAX,GAAqBJ,SAJd,EAKdF,OAAO,GAAGA,OAAO,CAACO,gBAAX,GAA8BL,SALvB,CAAhB;AAOAhC,EAAAA,qBAAqB,CAACsC,SAAtB,CAAgCL,OAAhC;AACAjC,EAAAA,qBAAqB,CAACuC,YAAtB,CAAmCN,OAAnC,EAA4C5B,WAA5C;AACA,SAAOA,WAAP;AACD;;;;"}